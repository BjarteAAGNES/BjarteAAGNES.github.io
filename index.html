
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NORDCAN SURVIVAL MODULE &#8212;   documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="#">  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NORDCAN SURVIVAL MODULE</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nordcan-survival-module">
<h1>NORDCAN SURVIVAL MODULE<a class="headerlink" href="#nordcan-survival-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="project-pages">
<h2>Project pages<a class="headerlink" href="#project-pages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="external">
<h3>external<a class="headerlink" href="#external" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>slack</dt><dd><p><a class="reference external" href="https://cancerregistr-hhd6843.slack.com/archives/CU73UB0EN">https://cancerregistr-hhd6843.slack.com/archives/CU73UB0EN</a></p>
</dd>
<dt>github</dt><dd><p><a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki</a></p>
</dd>
<dt>nordcan</dt><dd><p><a class="reference external" href="https://nordcan.iarc.fr/en">https://nordcan.iarc.fr/en</a></p>
</dd>
</dl>
</div>
<div class="section" id="internal-crn">
<h3>internal (CRN)<a class="headerlink" href="#internal-crn" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>confluence</dt><dd><p><a class="reference external" href="https://confluence.kreftregisteret.no/display/NOR/NORDCAN">https://confluence.kreftregisteret.no/display/NOR/NORDCAN</a></p>
</dd>
<dt>slides NORDCAN meeting</dt><dd><p><a class="reference external" href="file://H:/NORDCAN/NC_S/doc/NORDCAN_NC_S_REPORT_2020_04_29.html">file://H:/NORDCAN/NC_S/doc/NORDCAN_NC_S_REPORT_2020_04_29.html</a></p>
</dd>
<dt>flow chart</dt><dd><p><a class="reference external" href="file://H:/NORDCAN/NC_S/doc/NC_S_flow_chart.pdf">file://H:/NORDCAN/NC_S/doc/NC_S_flow_chart.pdf</a></p>
</dd>
</dl>
</div>
</div>
<hr class="docutils" />
<div class="section" id="package-description">
<h2>package description<a class="headerlink" href="#package-description" title="Permalink to this headline">¶</a></h2>
<p>nordcansurvival is a R package ( set of R functions ) calling <strong>Stata</strong> running the <strong>stnet</strong> program
using the <em>Pohar Perme estimator</em> with <em>Brenner weighting</em> to estimate age-standardized net survival.</p>
<div class="section" id="stnet">
<h3>stnet<a class="headerlink" href="#stnet" title="Permalink to this headline">¶</a></h3>
<p>stnet version 1.0.8 2020-06-11</p>
<p><a class="reference external" href="https://www.pauldickman.com/software/stnet/stnet/">https://www.pauldickman.com/software/stnet/stnet/</a></p>
<div class="line-block">
<div class="line">Enzo Coviello, Karri Seppä, Paul W. Dickman, Arun Pokhrel, 2015.</div>
<div class="line"><em>Estimating net survival using a life-table approach</em>,</div>
<div class="line">The Stata Journal, StataCorp LP, vol. 15(1), pages 173-185.</div>
</div>
<p><a class="reference external" href="https://www.pauldickman.com/pdf/Coviello2015.pdf">https://www.pauldickman.com/pdf/Coviello2015.pdf</a></p>
</div>
<div class="section" id="life-table">
<h3>life table<a class="headerlink" href="#life-table" title="Permalink to this headline">¶</a></h3>
<p>Life-table specification see
<a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Call-for-data-Survival">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Call-for-data-Survival</a></p>
</div>
<div class="section" id="age-standardization">
<h3>age-standardization<a class="headerlink" href="#age-standardization" title="Permalink to this headline">¶</a></h3>
<div class="section" id="method">
<h4>method<a class="headerlink" href="#method" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">The age-standardization method is described in</div>
<div class="line">Mark J. Rutherford, Paul W.Dickman, EnzoCoviello, Paul C.Lambert, 2020.</div>
<div class="line"><em>Estimation of age-standardized net survival, even when age-specific data are sparse</em></div>
</div>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1877782120300795">https://www.sciencedirect.com/science/article/pii/S1877782120300795</a></p>
</div>
<div class="section" id="weights">
<h4>weights<a class="headerlink" href="#weights" title="Permalink to this headline">¶</a></h4>
<p>ICSS 1-3 see <a class="reference external" href="https://www-dep.iarc.fr/nordcan/english/glossary.htm">https://www-dep.iarc.fr/nordcan/english/glossary.htm</a></p>
</div>
<div class="section" id="small-n-rule">
<h4>small N rule<a class="headerlink" href="#small-n-rule" title="Permalink to this headline">¶</a></h4>
<p>A entity group must have:</p>
<ol class="arabic simple">
<li><p>minimum 30 patients at start</p></li>
<li><p>minimum 05 patients at start in any agegroup used for standardization</p></li>
</ol>
</div>
</div>
<div class="section" id="input-nc-s-data">
<h3>Input: <em>NC-S data</em><a class="headerlink" href="#input-nc-s-data" title="Permalink to this headline">¶</a></h3>
<p>The input to the package should be <em>a proper NC-S dataset</em>.</p>
<div class="section" id="data-flow">
<h4>data flow<a class="headerlink" href="#data-flow" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>cancer registry [SELECT-PREPARE] → [d0]</p></li>
<li><p>NC DATA PRE [PREPROCESS]  → [d1] , [log] , [metadata]</p></li>
<li><p>NC DATA PRE [IARCchecktools]  → [d2], [log], [metadata]</p></li>
<li><p>NC DATA PRE [ENRICH]  → [d3], [log], [metadata]</p></li>
<li><p>NC SURV PRE [SURVIVAL ENRICH]  → [s1], [log], [metadata]</p></li>
<li><p>NC DATA SUR [<strong>FURTER SURVIAL SPECIFICATIONS</strong>] → [<strong>d_s1</strong>], [log], [metadata]</p></li>
</ol>
<dl class="simple">
<dt>d_s1</dt><dd><p>“Proper NC-S data” ( in memory R data.table → fwrite() → CSV (UTF-8) → Stata)</p>
</dd>
</dl>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>We are still considering what, if any, part of the <em>survival specifications whould</em> be part of &lt;ENRICH&gt;,
and what part(s) should be done separated from the <strong>&lt;ENRICH&gt;</strong>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Joonas: “… guiding principle is that <strong>what is needed _only_ in survival will not be part of general preprocessing</strong>”</p>
</div>
<ol class="arabic simple">
<li><p>subset of entity groups</p></li>
<li><p>not including DCO</p></li>
<li><p>One record ( first ca. ) per  patient × entity group</p></li>
<li><p>survival <strong>time &gt; 0</strong></p></li>
<li><p>information on <em>vit_sta</em>  ( dead, alive, emigrated )</p></li>
</ol>
</div>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>Results according to specification CSV (UTF-8). ** QUESTION: in “Statistical payload”. **</p>
<p><a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Module-Survival">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Module-Survival</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="to-do">
<h2><strong>TO DO</strong><a class="headerlink" href="#to-do" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>definition of survival file</strong></p></li>
<li><p>number of  analysis neccessary  I.  fup def ( cohort, period window 5 )</p></li>
<li><p>number of  analysis neccessary II.  memory constraints? :  All sites ( A, B, C, ), all other entities</p></li>
<li><p>small-n algoritm (esp. ISLAND)</p></li>
<li><p><strong>restrictions</strong> vs flexibility (first versions more restricted)</p></li>
<li><p>testing (NOR &gt; DEN &gt; ISL)</p></li>
</ul>
<div class="section" id="integration">
<h3>Integration<a class="headerlink" href="#integration" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>R: Integrate package nordcansurvival with nordcanepistats</p></li>
<li><p>R: documentation of package, and methods</p></li>
<li><p>documentation outside package?</p></li>
</ul>
</div>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<div class="section" id="to-be-installed-locally">
<h4>To be installed locally<a class="headerlink" href="#to-be-installed-locally" title="Permalink to this headline">¶</a></h4>
<p>Stata 14.1 , 15.2 , 16.1</p>
</div>
<div class="section" id="r-packages">
<h4>R-packages<a class="headerlink" href="#r-packages" title="Permalink to this headline">¶</a></h4>
<p>stringr</p>
</div>
<div class="section" id="stata-packages-programs">
<h4>Stata-packages (programs)<a class="headerlink" href="#stata-packages-programs" title="Permalink to this headline">¶</a></h4>
<p>All neccassary Stata programs, like stnet.ado, will be provided with the nordcansurvival package</p>
</div>
<div class="section" id="national-life-tables">
<h4>National life-tables<a class="headerlink" href="#national-life-tables" title="Permalink to this headline">¶</a></h4>
<p>Will be provided with the nordcansurvival package</p>
<p><a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Call-for-data-Survival">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Call-for-data-Survival</a></p>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="r-package-nordcansurvival">
<h1>R package nordcansurvival<a class="headerlink" href="#r-package-nordcansurvival" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>provide survival statistics comparable between countries and over time</p></li>
<li><p>primary work-flow: <em>automated/batch</em> within the NORDCAN R-package</p></li>
<li><p><em>documented</em>: methods/code/results/metadata, including automated logging</p></li>
<li><p><strong>easy to maintain and extend ( by CRN survival group )</strong></p></li>
<li><p><strong>can be used standalone in R</strong></p></li>
<li><p><strong>can be used *the same way* from R and Stata</strong></p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<div class="section" id="nordcansurvival-should-provide-functions-for">
<h3>nordcansurvival should provide functions for<a class="headerlink" href="#nordcansurvival-should-provide-functions-for" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>any extra survival prepocessing</p></li>
<li><p>statistics</p></li>
<li><p>export of statistics, detailed survival statistics, meta-data, log-files</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>nordcanpackages
                            +----------------------------+
nordcanepistats             | nordcansurvival            |
       |                    +----------------------------+
       |                    |  surv_preprocessing()      |  nordcansurvival_surv_preprossessing.r
       |                    +----------------------------+
       |                    |  surv_define_follow_up()   |  nordcansurvival_surv_define_follow_up.r
       |                    |  surv_statistics()         |  nordcansurvival_surv_statistics.r
       |                    |  surv_export()             |  nordcansurvival_surv_export.r
       |                    +----------------------------+
       +---------------&gt;    |  surv_main()               |  calling the above functions
                            +----------------------------+  to do a complete analysis according to spec.

                          surv_export() return/export files:

                          - statistics for publication
                          - detailed statistics (not for publication)
                          - log files of processing
                          - meta data
</pre></div>
</div>
<img alt="_images/flow.svg" src="flow.svg" /><ul class="simple">
<li><p><em>surv_preprocessing()</em> might not be neccassary (for first version)</p></li>
</ul>
</div>
</div>
<div class="section" id="use-case-r-nordcansurvival">
<h2>Use case: R nordcansurvival<a class="headerlink" href="#use-case-r-nordcansurvival" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-nordcanepistats">
<h3>from nordcanepistats<a class="headerlink" href="#from-nordcanepistats" title="Permalink to this headline">¶</a></h3>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [define cohort fup] → [analyze] → [export] ( data.table in {statistical payload} &lt;- fread(input) )</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_main</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># run all analyses and export resulst to statistical payload</span>
</pre></div>
</div>
</div>
<div class="section" id="from-nordcansurvival">
<h3>from nordcansurvival<a class="headerlink" href="#from-nordcansurvival" title="Permalink to this headline">¶</a></h3>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [preprocess] → [define cohort fup] → [analyze]</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_preprocess</span><span class="p">()</span>  <span class="c1"># may not be neccassary ( in first version )</span>
<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_define_follow_up</span><span class="p">(</span><span class="n">cohort</span><span class="p">)</span>
<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_statistics</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">stnet</span><span class="p">,</span> <span class="n">pohar</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="c1"># defaults to NC specification</span>
</pre></div>
</div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [define period fup] → [analyze]</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_define_follow_up</span><span class="p">(</span><span class="n">period_window</span><span class="p">,</span> <span class="n">start_date</span> <span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>  <span class="c1"># 5-year and 10-year (selected intities)</span>
<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_statistics</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">pohar</span><span class="p">,</span> <span class="n">stnet</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="c1"># defaults to NC specification</span>
</pre></div>
</div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [export]</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_export</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span> <span class="c1"># →  data.table in {statistical payload} &lt;- fread(input)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="number-of-analysis-neccessary-nordcansurvival-surv-statistics">
<h2>Number of analysis neccessary ( nordcansurvival::surv_statistics )<a class="headerlink" href="#number-of-analysis-neccessary-nordcansurvival-surv-statistics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="follow-up">
<h3>Follow-up:<a class="headerlink" href="#follow-up" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li><p>cohort definition 0-10 years (all but last calendar period(s))</p></li>
<li><p>5-year period definition for 05/10 year survival (last calendar period)</p></li>
</ol>
</div></blockquote>
<p>Any subsetting necessary due to memmory constraints.</p>
</div>
<div class="section" id="one-row-per-group-to-be-analysed">
<h3>One row per group to be analysed:<a class="headerlink" href="#one-row-per-group-to-be-analysed" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li><p>All sites</p></li>
<li><p>All sites but non-melanoma skin cancer</p></li>
<li><p>All sites but non-melanoma skin cancer, breast and prostate</p></li>
<li><p>other groups to be analyzed</p></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="nordcansurvival-functions">
<h3>nordcansurvival functions<a class="headerlink" href="#nordcansurvival-functions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="preprocessing">
<h4>preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>exclutions</p></li>
<li><p>asserts</p></li>
<li><p>possibly adding variables</p></li>
</ol>
</div>
<div class="section" id="defining-fup">
<h4>defining fup<a class="headerlink" href="#defining-fup" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>cohort</p></li>
<li><p>period window last five-year calendar period</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Use case: R nordcansurvival<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NORDCAN SURVIVAL MODULE</a><ul>
<li><a class="reference internal" href="#project-pages">Project pages</a><ul>
<li><a class="reference internal" href="#external">external</a></li>
<li><a class="reference internal" href="#internal-crn">internal (CRN)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#package-description">package description</a><ul>
<li><a class="reference internal" href="#stnet">stnet</a></li>
<li><a class="reference internal" href="#life-table">life table</a></li>
<li><a class="reference internal" href="#age-standardization">age-standardization</a><ul>
<li><a class="reference internal" href="#method">method</a></li>
<li><a class="reference internal" href="#weights">weights</a></li>
<li><a class="reference internal" href="#small-n-rule">small N rule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#input-nc-s-data">Input: <em>NC-S data</em></a><ul>
<li><a class="reference internal" href="#data-flow">data flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#to-do"><strong>TO DO</strong></a><ul>
<li><a class="reference internal" href="#integration">Integration</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li><a class="reference internal" href="#to-be-installed-locally">To be installed locally</a></li>
<li><a class="reference internal" href="#r-packages">R-packages</a></li>
<li><a class="reference internal" href="#stata-packages-programs">Stata-packages (programs)</a></li>
<li><a class="reference internal" href="#national-life-tables">National life-tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#r-package-nordcansurvival">R package nordcansurvival</a><ul>
<li><a class="reference internal" href="#objectives">Objectives</a><ul>
<li><a class="reference internal" href="#nordcansurvival-should-provide-functions-for">nordcansurvival should provide functions for</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-case-r-nordcansurvival">Use case: R nordcansurvival</a><ul>
<li><a class="reference internal" href="#from-nordcanepistats">from nordcanepistats</a></li>
<li><a class="reference internal" href="#from-nordcansurvival">from nordcansurvival</a></li>
</ul>
</li>
<li><a class="reference internal" href="#number-of-analysis-neccessary-nordcansurvival-surv-statistics">Number of analysis neccessary ( nordcansurvival::surv_statistics )</a><ul>
<li><a class="reference internal" href="#follow-up">Follow-up:</a></li>
<li><a class="reference internal" href="#one-row-per-group-to-be-analysed">One row per group to be analysed:</a></li>
<li><a class="reference internal" href="#nordcansurvival-functions">nordcansurvival functions</a><ul>
<li><a class="reference internal" href="#preprocessing">preprocessing</a></li>
<li><a class="reference internal" href="#defining-fup">defining fup</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id1">Use case: R nordcansurvival</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="#">  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NORDCAN SURVIVAL MODULE</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>
