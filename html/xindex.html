
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NORDCAN SURVIVAL MODULE &#8212;   documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NORDCAN SURVIVAL MODULE</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nordcan-survival-module">
<h1>NORDCAN SURVIVAL MODULE<a class="headerlink" href="#nordcan-survival-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="project-pages">
<h2>Project pages<a class="headerlink" href="#project-pages" title="Permalink to this headline">¶</a></h2>
<div class="section" id="external">
<h3>external<a class="headerlink" href="#external" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>slack</dt><dd><p><a class="reference external" href="https://cancerregistr-hhd6843.slack.com/archives/CU73UB0EN">https://cancerregistr-hhd6843.slack.com/archives/CU73UB0EN</a></p>
</dd>
<dt>github</dt><dd><p><a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki</a></p>
</dd>
<dt>nordcan</dt><dd><p><a class="reference external" href="https://nordcan.iarc.fr/en">https://nordcan.iarc.fr/en</a></p>
</dd>
</dl>
</div>
<div class="section" id="internal-crn">
<h3>internal (CRN)<a class="headerlink" href="#internal-crn" title="Permalink to this headline">¶</a></h3>
<dl class="simple">
<dt>confluence</dt><dd><p><a class="reference external" href="https://confluence.kreftregisteret.no/display/NOR/NORDCAN">https://confluence.kreftregisteret.no/display/NOR/NORDCAN</a></p>
</dd>
<dt>slides NORDCAN meeting</dt><dd><p><a class="reference external" href="file://H:/NORDCAN/NC_S/doc/NORDCAN_NC_S_REPORT_2020_04_29.html">file://H:/NORDCAN/NC_S/doc/NORDCAN_NC_S_REPORT_2020_04_29.html</a></p>
</dd>
<dt>flow chart</dt><dd><p><a class="reference external" href="file://H:/NORDCAN/NC_S/doc/NC_S_flow_chart.pdf">file://H:/NORDCAN/NC_S/doc/NC_S_flow_chart.pdf</a></p>
</dd>
</dl>
</div>
</div>
<hr class="docutils" />
<div class="section" id="package-description">
<h2>package description<a class="headerlink" href="#package-description" title="Permalink to this headline">¶</a></h2>
<p>nordcansurvival is a R package ( set of R functions ) calling <strong>Stata</strong> running the <strong>stnet</strong> program
using the <em>Pohar Perme estimator</em> with <em>Brenner weighting</em> to estimate age-standardized net survival.</p>
<div class="section" id="stnet">
<h3>stnet<a class="headerlink" href="#stnet" title="Permalink to this headline">¶</a></h3>
<p>stnet version 1.0.8 2020-06-11</p>
<p><a class="reference external" href="https://www.pauldickman.com/software/stnet/stnet/">https://www.pauldickman.com/software/stnet/stnet/</a></p>
<div class="line-block">
<div class="line">Enzo Coviello, Karri Seppä, Paul W. Dickman, Arun Pokhrel, 2015.</div>
<div class="line"><em>Estimating net survival using a life-table approach</em>,</div>
<div class="line">The Stata Journal, StataCorp LP, vol. 15(1), pages 173-185.</div>
</div>
<p><a class="reference external" href="https://www.pauldickman.com/pdf/Coviello2015.pdf">https://www.pauldickman.com/pdf/Coviello2015.pdf</a></p>
</div>
<div class="section" id="life-table">
<h3>life table<a class="headerlink" href="#life-table" title="Permalink to this headline">¶</a></h3>
<p>Life-table specification see
<a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Call-for-data-Survival">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Call-for-data-Survival</a></p>
</div>
<div class="section" id="age-standardization">
<h3>age-standardization<a class="headerlink" href="#age-standardization" title="Permalink to this headline">¶</a></h3>
<div class="section" id="method">
<h4>method<a class="headerlink" href="#method" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">The age-standardization method is described in</div>
<div class="line">Mark J. Rutherford, Paul W.Dickman, EnzoCoviello, Paul C.Lambert, 2020.</div>
<div class="line"><em>Estimation of age-standardized net survival, even when age-specific data are sparse</em></div>
</div>
<p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1877782120300795">https://www.sciencedirect.com/science/article/pii/S1877782120300795</a></p>
</div>
<div class="section" id="weights">
<h4>weights<a class="headerlink" href="#weights" title="Permalink to this headline">¶</a></h4>
<p>ICSS 1-3 see <a class="reference external" href="https://www-dep.iarc.fr/nordcan/english/glossary.htm">https://www-dep.iarc.fr/nordcan/english/glossary.htm</a></p>
</div>
<div class="section" id="small-n-rule">
<h4>small N rule<a class="headerlink" href="#small-n-rule" title="Permalink to this headline">¶</a></h4>
<p>A entity group must have:</p>
<ol class="arabic simple">
<li><p>minimum 30 patients at start</p></li>
<li><p>minimum 05 patients at start in any agegroup</p></li>
</ol>
</div>
</div>
<div class="section" id="input-nc-s-data">
<h3>Input: <em>NC-S data</em><a class="headerlink" href="#input-nc-s-data" title="Permalink to this headline">¶</a></h3>
<p>The input to the package should be <em>a proper NC-S dataset</em>.</p>
<div class="section" id="data-flow">
<h4>data flow<a class="headerlink" href="#data-flow" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>cancer registry [SELECT-PREPARE] → [d0]</p></li>
<li><p>NC DATA PRE [PREPROCESS]  → [d1] , [log] , [metadata]</p></li>
<li><p>NC DATA PRE [IARCchecktools]  → [d2], [log], [metadata]</p></li>
<li><p>NC DATA PRE [ENRICH]  → [d3], [log], [metadata]</p></li>
<li><p>NC SURV PRE [SURVIVAL ENRICH]  → [s1], [log], [metadata]</p></li>
<li><p>NC DATA SUR [<strong>FURTER SURVIAL SPECIFICATIONS</strong>] → [<strong>d_s1</strong>], [log], [metadata]</p></li>
</ol>
<dl class="simple">
<dt>d_s1</dt><dd><p>“Proper NC-S data” ( in memory R data.table → fwrite() → CSV (UTF-8) → Stata)</p>
</dd>
</dl>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>We are still considering what, if any, part of the <em>survival specifications whould</em> be part of &lt;ENRICH&gt;,
and what part(s) should be done separated from the <strong>&lt;ENRICH&gt;</strong>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Joonas: “… guiding principle is that <strong>what is needed _only_ in survival will not be part of general preprocessing</strong>”</p>
</div>
<ol class="arabic simple">
<li><p>subset of entity groups</p></li>
<li><p>not including DCO</p></li>
<li><p>One record ( first ca. ) per  patient × entity group</p></li>
<li><p>survival <strong>time &gt; 0</strong></p></li>
<li><p>information on <em>vit_sta</em>  ( dead, alive, emigrated )</p></li>
</ol>
</div>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>Results according to specification CSV (UTF-8). ** QUESTION: in “Statistical payload”. **</p>
<p><a class="reference external" href="https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Module-Survival">https://github.com/CancerRegistryOfNorway/NORDCAN/wiki/Module-Survival</a></p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="to-do">
<h2><strong>TO DO</strong><a class="headerlink" href="#to-do" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>definition of survival file</strong></p></li>
<li><p>number of  analysis neccessary  I.  fup def ( cohort, period window 5, period window 10 )</p></li>
<li><p>number of  analysis neccessary II.  memory constraints? :  All sites ( A, B, C, ), all other entities</p></li>
<li><p>small-n algoritm (esp. ISLAND)</p></li>
<li><p><strong>restrictions</strong> vs flexibility (first versions more restricted)</p></li>
<li><p>testing (NOR &gt; DEN &gt; ISL)</p></li>
</ul>
<div class="section" id="integration">
<h3>Integration<a class="headerlink" href="#integration" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>R: Integrate package nordcansurvival with nordcanepistats</p></li>
<li><p>R: documentation of package, and methods</p></li>
<li><p>documentation outside package?</p></li>
</ul>
</div>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<div class="section" id="to-be-installed-locally">
<h4>To be installed locally<a class="headerlink" href="#to-be-installed-locally" title="Permalink to this headline">¶</a></h4>
<p>Stata 14.1 , 15.2 , 16.1</p>
</div>
<div class="section" id="r-packages">
<h4>R-packages<a class="headerlink" href="#r-packages" title="Permalink to this headline">¶</a></h4>
<p>stringr</p>
</div>
<div class="section" id="stata-packages">
<h4>Stata-packages<a class="headerlink" href="#stata-packages" title="Permalink to this headline">¶</a></h4>
<p>Stata stnet.ado will be provided with the nordcansurvival package</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="issues">
<h2>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://nordcan.iarc.fr/en/database">https://nordcan.iarc.fr/en/database</a></p>
<p>5.  The survival data originated from the project “The survival of cancer patients diagnosed 1964-2003 in the Nordic countries”,
published in Acta Oncologica issue 5 in 2010, now updated and supplemented with 1-year survival and calculations for more recent periods.
Links to the papers can be found at <a class="reference external" href="http://www.ancr.nu/cancer-data/cancer-survival/">http://www.ancr.nu/cancer-data/cancer-survival/</a></p>
<p>1.a) <strong>Breast cancer in men and “Pharynx, ill-defined” are not included in the entity “All sites” or in other summary groups when calculating survival.</strong>
Therefore, the numbers of cases in the quality tables for incidence and for survival are different from the numbers in those groups.</p>
<p>To get the survival <em>entities</em></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>OUT OF ORDER!</strong></p>
</div>
<p><a class="reference external" href="https://nordcan.iarc.fr/en/dataviz/survival_table">https://nordcan.iarc.fr/en/dataviz/survival_table</a></p>
<details>
<summary><a>TABLE: dataset-age-standardized-relative-survival-males-age-0-89-diagnosed-2012-2016.csv </a></summary><table class="colwidths-auto docutils align-default" id="id2">
<caption><span class="caption-text">dataset-age-standardized-relative-survival-males-age-0-89-diagnosed-2012-2016.csv</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Label</p></th>
<th class="head"><p>Denmark</p></th>
<th class="head"><p>Finland</p></th>
<th class="head"><p>Norway</p></th>
<th class="head"><p>Sweden</p></th>
<th class="head"><p>Iceland</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lip</p></td>
<td><p>89</p></td>
<td><p>92</p></td>
<td><p>92</p></td>
<td><p>91</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Oral cavity</p></td>
<td><p>51</p></td>
<td><p>60</p></td>
<td><p>57</p></td>
<td><p>57</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Salivary glands</p></td>
<td><p>59</p></td>
<td><p>67</p></td>
<td><p>60</p></td>
<td><p>66</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Oropharynx</p></td>
<td><p>55</p></td>
<td><p>55</p></td>
<td><p>59</p></td>
<td><p>63</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Nasopharynx</p></td>
<td><p>59</p></td>
<td><p>48</p></td>
<td><p>56</p></td>
<td><p>62</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Hypopharynx</p></td>
<td><p>26</p></td>
<td><p>26</p></td>
<td><p>34</p></td>
<td><p>22</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Oesophagus</p></td>
<td><p>14</p></td>
<td><p>13</p></td>
<td><p>19</p></td>
<td><p>14</p></td>
<td><p>26</p></td>
</tr>
<tr class="row-odd"><td><p>Stomach</p></td>
<td><p>24</p></td>
<td><p>24</p></td>
<td><p>27</p></td>
<td><p>24</p></td>
<td><p>28</p></td>
</tr>
<tr class="row-even"><td><p>Small intestine</p></td>
<td><p>48</p></td>
<td><p>59</p></td>
<td><p>65</p></td>
<td><p>61</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Colon</p></td>
<td><p>63</p></td>
<td><p>65</p></td>
<td><p>63</p></td>
<td><p>64</p></td>
<td><p>62</p></td>
</tr>
<tr class="row-even"><td><p>Rectum and anus</p></td>
<td><p>66</p></td>
<td><p>64</p></td>
<td><p>68</p></td>
<td><p>64</p></td>
<td><p>67</p></td>
</tr>
<tr class="row-odd"><td><p>Liver</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
<td><p>16</p></td>
<td><p>18</p></td>
<td><p>19</p></td>
</tr>
<tr class="row-even"><td><p>Gallbladder</p></td>
<td><p>17</p></td>
<td><p>15</p></td>
<td><p>18</p></td>
<td><p>18</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-odd"><td><p>Pancreas</p></td>
<td><p>7</p></td>
<td><p>7</p></td>
<td><p>9</p></td>
<td><p>11</p></td>
<td><p>9</p></td>
</tr>
<tr class="row-even"><td><p>Nose, sinuses</p></td>
<td><p>54</p></td>
<td><p>57</p></td>
<td><p>55</p></td>
<td><p>51</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Larynx</p></td>
<td><p>65</p></td>
<td><p>58</p></td>
<td><p>66</p></td>
<td><p>69</p></td>
<td><p>63</p></td>
</tr>
<tr class="row-even"><td><p>Lung</p></td>
<td><p>14</p></td>
<td><p>12</p></td>
<td><p>17</p></td>
<td><p>17</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td><p>Pleura</p></td>
<td><p>8</p></td>
<td><p>9</p></td>
<td><p>5</p></td>
<td><p>8</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Prostate</p></td>
<td><p>87</p></td>
<td><p>94</p></td>
<td><p>93</p></td>
<td><p>91</p></td>
<td><p>90</p></td>
</tr>
<tr class="row-odd"><td><p>Testis</p></td>
<td><p>97</p></td>
<td><p>92</p></td>
<td><p>94</p></td>
<td><p>96</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Penis, etc.</p></td>
<td><p>76</p></td>
<td><p>69</p></td>
<td><p>78</p></td>
<td><p>75</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Kidney</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
<td><p>70</p></td>
<td><p>72</p></td>
<td><p>63</p></td>
</tr>
<tr class="row-even"><td><p>Bladder, etc.</p></td>
<td><p>75</p></td>
<td><p>79</p></td>
<td><p>79</p></td>
<td><p>77</p></td>
<td><p>80</p></td>
</tr>
<tr class="row-odd"><td><p>Melanoma of skin</p></td>
<td><p>90</p></td>
<td><p>87</p></td>
<td><p>86</p></td>
<td><p>90</p></td>
<td><p>83</p></td>
</tr>
<tr class="row-even"><td><p>Skin, non-melanoma</p></td>
<td><p>89</p></td>
<td><p>93</p></td>
<td><p>89</p></td>
<td><p>91</p></td>
<td><p>91</p></td>
</tr>
<tr class="row-odd"><td><p>Eye</p></td>
<td><p>71</p></td>
<td><p>61</p></td>
<td><p>73</p></td>
<td><p>70</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Brain, central nervous system</p></td>
<td><p>61</p></td>
<td><p>52</p></td>
<td><p>57</p></td>
<td><p>61</p></td>
<td><p>51</p></td>
</tr>
<tr class="row-odd"><td><p>Thyroid</p></td>
<td><p>83</p></td>
<td><p>87</p></td>
<td><p>90</p></td>
<td><p>83</p></td>
<td><p>90</p></td>
</tr>
<tr class="row-even"><td><p>Bone</p></td>
<td><p>63</p></td>
<td><p>56</p></td>
<td><p>60</p></td>
<td><p>74</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Soft tissues</p></td>
<td><p>67</p></td>
<td><p>68</p></td>
<td><p>74</p></td>
<td><p>71</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Non-Hodgkin lymphoma</p></td>
<td><p>72</p></td>
<td><p>66</p></td>
<td><p>70</p></td>
<td><p>71</p></td>
<td><p>72</p></td>
</tr>
<tr class="row-odd"><td><p>Hodgkin lymphoma</p></td>
<td><p>89</p></td>
<td><p>86</p></td>
<td><p>84</p></td>
<td><p>86</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Multiple myeloma</p></td>
<td><p>55</p></td>
<td><p>43</p></td>
<td><p>49</p></td>
<td><p>54</p></td>
<td><p>56</p></td>
</tr>
<tr class="row-odd"><td><p>Myelodysplastic syndromes</p></td>
<td><p>42</p></td>
<td><p>15</p></td>
<td><p>37</p></td>
<td><p>42</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Myeloproliferative diseases</p></td>
<td><p>75</p></td>
<td><p>69</p></td>
<td><p>80</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Other malignant haematopoietic diseases</p></td>
<td><p>74</p></td>
<td><p>81</p></td>
<td><p>91</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Leukaemia</p></td>
<td><p>63</p></td>
<td><p>57</p></td>
<td><p>61</p></td>
<td><p>64</p></td>
<td><p>65</p></td>
</tr>
<tr class="row-odd"><td><p>Chronic lymphocytic leukaemia</p></td>
<td><p>84</p></td>
<td><p>77</p></td>
<td><p>85</p></td>
<td><p>81</p></td>
<td><p>85</p></td>
</tr>
<tr class="row-even"><td><p>Other and unspecified lymphoid leukaemia</p></td>
<td><p>74</p></td>
<td><p>86</p></td>
<td><p>77</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Acute myeloid leukaemia</p></td>
<td><p>22</p></td>
<td><p>19</p></td>
<td><p>19</p></td>
<td><p>27</p></td>
<td><p>16</p></td>
</tr>
<tr class="row-even"><td><p>Chronic myeloid leukaemia</p></td>
<td><p>56</p></td>
<td><p>58</p></td>
<td><p>53</p></td>
<td><p>64</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Other and unspecified myeloid leukaemia</p></td>
<td><p>25</p></td>
<td><p>26</p></td>
<td><p>26</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Leukaemia, cell unspecified</p></td>
<td><p>30</p></td>
<td><p>32</p></td>
<td><p>41</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Other specified cancers</p></td>
<td><p>35</p></td>
<td><p>40</p></td>
<td><p>47</p></td>
<td><p>55</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Unknown and ill-defined</p></td>
<td><p>22</p></td>
<td><p>20</p></td>
<td><p>18</p></td>
<td><p>19</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-odd"><td><p>Malignant haematopoietic diseases</p></td>
<td><p>65</p></td>
<td><p>60</p></td>
<td><p>65</p></td>
<td><p>66</p></td>
<td><p>66</p></td>
</tr>
<tr class="row-even"><td><p>All sites</p></td>
<td><p>62</p></td>
<td><p>65</p></td>
<td><p>69</p></td>
<td><p>71</p></td>
<td><p>66</p></td>
</tr>
<tr class="row-odd"><td><p>All sites except non-melanoma skin cancer</p></td>
<td><p>60</p></td>
<td><p>64</p></td>
<td><p>68</p></td>
<td><p>69</p></td>
<td><p>64</p></td>
</tr>
<tr class="row-even"><td><p>All sites except non-melanoma skin, breast, and prostate cancer</p></td>
<td><p>52</p></td>
<td><p>49</p></td>
<td><p>56</p></td>
<td><p>56</p></td>
<td><p>52</p></td>
</tr>
<tr class="row-odd"><td><p>Lip, oral cavity, and pharynx</p></td>
<td><p>53</p></td>
<td><p>63</p></td>
<td><p>65</p></td>
<td><p>64</p></td>
<td><p>59</p></td>
</tr>
<tr class="row-even"><td><p>Colorectum</p></td>
<td><p>64</p></td>
<td><p>65</p></td>
<td><p>65</p></td>
<td><p>64</p></td>
<td><p>64</p></td>
</tr>
</tbody>
</table>
</details><p><a class="reference external" href="https://nordcan.iarc.fr/en/dataviz/tables?mode=cancer&amp;group_populations=1&amp;sexes=1&amp;map_view_per=all">https://nordcan.iarc.fr/en/dataviz/tables?mode=cancer&amp;group_populations=1&amp;sexes=1&amp;map_view_per=all</a></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The exported csv does not include the <strong>order</strong></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>the <strong>order</strong> is NOT an <em>entity order-ID</em> but just the observed row ordering in THIS table (Males only)</p>
</div>
<details>
<summary><a>TABLE: dataset-incidence-males-in-2016denmark-finland-iceland-norway-sweden.csv</a></summary><table class="colwidths-auto docutils align-default" id="id3">
<caption><span class="caption-text">dataset-incidence-males-in-2016denmark-finland-iceland-norway-sweden.csv</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Cancer site</p></th>
<th class="head"><p>ASR (World)</p></th>
<th class="head"><p>ASR (Nordic)</p></th>
<th class="head"><p>ASR (Europe)</p></th>
<th class="head"><p>Crude Rate</p></th>
<th class="head"><p>Cum. risk [0-74]</p></th>
<th class="head"><p>Order</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>All sites</p></td>
<td><p>326.2</p></td>
<td><p>628.7</p></td>
<td><p>477.2</p></td>
<td><p>662.2</p></td>
<td><p>32.1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>All sites except non-melanoma skin cancer</p></td>
<td><p>308.0</p></td>
<td><p>579.1</p></td>
<td><p>446.5</p></td>
<td><p>614.4</p></td>
<td><p>31.0</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>All sites except non-melanoma skin, breast, and prostate cancer</p></td>
<td><p>217.6</p></td>
<td><p>404.3</p></td>
<td><p>311.7</p></td>
<td><p>423.0</p></td>
<td><p>22.1</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Lip, oral cavity, and pharynx</p></td>
<td><p>9.6</p></td>
<td><p>16.0</p></td>
<td><p>13.5</p></td>
<td><p>17.2</p></td>
<td><p>1.2</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Lip</p></td>
<td><p>0.57</p></td>
<td><p>1.4</p></td>
<td><p>0.92</p></td>
<td><p>1.4</p></td>
<td><p>0.06</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Oral cavity</p></td>
<td><p>3.0</p></td>
<td><p>5.1</p></td>
<td><p>4.2</p></td>
<td><p>5.4</p></td>
<td><p>0.37</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Oropharynx</p></td>
<td><p>4.2</p></td>
<td><p>6.3</p></td>
<td><p>5.8</p></td>
<td><p>6.9</p></td>
<td><p>0.52</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Salivary glands</p></td>
<td><p>0.78</p></td>
<td><p>1.4</p></td>
<td><p>1.1</p></td>
<td><p>1.5</p></td>
<td><p>0.08</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Nasopharynx</p></td>
<td><p>0.31</p></td>
<td><p>0.46</p></td>
<td><p>0.40</p></td>
<td><p>0.48</p></td>
<td><p>0.03</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Hypopharynx</p></td>
<td><p>0.72</p></td>
<td><p>1.2</p></td>
<td><p>1.0</p></td>
<td><p>1.4</p></td>
<td><p>0.10</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Pharynx, ill-defined</p></td>
<td><p>0.07</p></td>
<td><p>0.12</p></td>
<td><p>0.10</p></td>
<td><p>0.13</p></td>
<td><p>0.01</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Oesophagus</p></td>
<td><p>4.3</p></td>
<td><p>8.2</p></td>
<td><p>6.4</p></td>
<td><p>8.9</p></td>
<td><p>0.56</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Stomach</p></td>
<td><p>5.4</p></td>
<td><p>10.8</p></td>
<td><p>8.2</p></td>
<td><p>11.4</p></td>
<td><p>0.65</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Small intestine</p></td>
<td><p>1.7</p></td>
<td><p>3.2</p></td>
<td><p>2.5</p></td>
<td><p>3.3</p></td>
<td><p>0.20</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Colorectum</p></td>
<td><p>36.9</p></td>
<td><p>75.2</p></td>
<td><p>55.5</p></td>
<td><p>78.5</p></td>
<td><p>4.3</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Colon</p></td>
<td><p>22.4</p></td>
<td><p>47.3</p></td>
<td><p>34.1</p></td>
<td><p>48.9</p></td>
<td><p>2.6</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Rectum and anus</p></td>
<td><p>14.5</p></td>
<td><p>27.9</p></td>
<td><p>21.4</p></td>
<td><p>29.6</p></td>
<td><p>1.7</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Liver</p></td>
<td><p>4.8</p></td>
<td><p>9.3</p></td>
<td><p>7.1</p></td>
<td><p>9.9</p></td>
<td><p>0.59</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Gallbladder</p></td>
<td><p>1.8</p></td>
<td><p>3.5</p></td>
<td><p>2.6</p></td>
<td><p>3.7</p></td>
<td><p>0.21</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Pancreas</p></td>
<td><p>7.6</p></td>
<td><p>15.1</p></td>
<td><p>11.4</p></td>
<td><p>16.1</p></td>
<td><p>0.97</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Unknown and ill-defined</p></td>
<td><p>4.8</p></td>
<td><p>10.0</p></td>
<td><p>7.3</p></td>
<td><p>10.3</p></td>
<td><p>0.54</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Nose, sinuses</p></td>
<td><p>0.54</p></td>
<td><p>0.91</p></td>
<td><p>0.74</p></td>
<td><p>0.99</p></td>
<td><p>0.07</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Larynx</p></td>
<td><p>2.0</p></td>
<td><p>3.8</p></td>
<td><p>3.0</p></td>
<td><p>4.1</p></td>
<td><p>0.26</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Lung</p></td>
<td><p>25.7</p></td>
<td><p>53.0</p></td>
<td><p>39.1</p></td>
<td><p>56.5</p></td>
<td><p>3.2</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Pleura</p></td>
<td><p>0.96</p></td>
<td><p>2.2</p></td>
<td><p>1.5</p></td>
<td><p>2.3</p></td>
<td><p>0.12</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Bone</p></td>
<td><p>0.93</p></td>
<td><p>1.0</p></td>
<td><p>0.98</p></td>
<td><p>1.0</p></td>
<td><p>0.08</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Melanoma of skin</p></td>
<td><p>21.6</p></td>
<td><p>37.5</p></td>
<td><p>30.3</p></td>
<td><p>39.0</p></td>
<td><p>2.4</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Skin, non-melanoma</p></td>
<td><p>18.2</p></td>
<td><p>49.6</p></td>
<td><p>30.7</p></td>
<td><p>47.8</p></td>
<td><p>1.6</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Soft tissues</p></td>
<td><p>2.2</p></td>
<td><p>3.5</p></td>
<td><p>2.8</p></td>
<td><p>3.6</p></td>
<td><p>0.22</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Breast</p></td>
<td><p>0.62</p></td>
<td><p>1.2</p></td>
<td><p>0.90</p></td>
<td><p>1.2</p></td>
<td><p>0.08</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Penis, etc.</p></td>
<td><p>1.2</p></td>
<td><p>2.4</p></td>
<td><p>1.8</p></td>
<td><p>2.4</p></td>
<td><p>0.13</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Prostate</p></td>
<td><p>89.8</p></td>
<td><p>173.6</p></td>
<td><p>133.9</p></td>
<td><p>190.2</p></td>
<td><p>11.3</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Testis</p></td>
<td><p>7.9</p></td>
<td><p>8.5</p></td>
<td><p>8.5</p></td>
<td><p>8.2</p></td>
<td><p>0.61</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Kidney</p></td>
<td><p>10.5</p></td>
<td><p>18.0</p></td>
<td><p>14.8</p></td>
<td><p>19.3</p></td>
<td><p>1.3</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Bladder, etc.</p></td>
<td><p>19.7</p></td>
<td><p>44.1</p></td>
<td><p>30.8</p></td>
<td><p>45.4</p></td>
<td><p>2.2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Eye</p></td>
<td><p>0.77</p></td>
<td><p>1.2</p></td>
<td><p>0.99</p></td>
<td><p>1.2</p></td>
<td><p>0.08</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Brain, central nervous system</p></td>
<td><p>11.7</p></td>
<td><p>16.6</p></td>
<td><p>14.6</p></td>
<td><p>17.3</p></td>
<td><p>1.2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Thyroid</p></td>
<td><p>2.7</p></td>
<td><p>3.9</p></td>
<td><p>3.5</p></td>
<td><p>4.0</p></td>
<td><p>0.28</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Malignant haematopoietic diseases</p></td>
<td><p>31.0</p></td>
<td><p>54.9</p></td>
<td><p>42.8</p></td>
<td><p>56.8</p></td>
<td><p>3.3</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Hodgkin lymphoma</p></td>
<td><p>2.4</p></td>
<td><p>2.8</p></td>
<td><p>2.7</p></td>
<td><p>2.9</p></td>
<td><p>0.21</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Non-Hodgkin lymphoma</p></td>
<td><p>10.7</p></td>
<td><p>20.0</p></td>
<td><p>15.4</p></td>
<td><p>20.8</p></td>
<td><p>1.2</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Multiple myeloma</p></td>
<td><p>4.0</p></td>
<td><p>8.2</p></td>
<td><p>6.0</p></td>
<td><p>8.5</p></td>
<td><p>0.47</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Leukaemia</p></td>
<td><p>9.3</p></td>
<td><p>15.1</p></td>
<td><p>12.1</p></td>
<td><p>15.6</p></td>
<td><p>0.91</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Acute lymphoblastic leukaemia</p></td>
<td><p>2.0</p></td>
<td><p>1.5</p></td>
<td><p>1.6</p></td>
<td><p>1.5</p></td>
<td><p>0.12</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Chronic lymphocytic leukaemia</p></td>
<td><p>3.6</p></td>
<td><p>7.2</p></td>
<td><p>5.4</p></td>
<td><p>7.5</p></td>
<td><p>0.43</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Other and unspecified lymphoid leukaemia</p></td>
<td><p>0.48</p></td>
<td><p>0.81</p></td>
<td><p>0.67</p></td>
<td><p>0.83</p></td>
<td><p>0.05</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Acute myeloid leukaemia</p></td>
<td><p>1.4</p></td>
<td><p>2.6</p></td>
<td><p>1.9</p></td>
<td><p>2.7</p></td>
<td><p>0.14</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Chronic myeloid leukaemia</p></td>
<td><p>1.2</p></td>
<td><p>1.9</p></td>
<td><p>1.6</p></td>
<td><p>2.0</p></td>
<td><p>0.12</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Other and unspecified myeloid leukaemia</p></td>
<td><p>0.47</p></td>
<td><p>0.74</p></td>
<td><p>0.60</p></td>
<td><p>0.76</p></td>
<td><p>0.05</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Leukaemia, cell unspecified</p></td>
<td><p>0.14</p></td>
<td><p>0.27</p></td>
<td><p>0.18</p></td>
<td><p>0.25</p></td>
<td><p>0.01</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Myeloproliferative diseases</p></td>
<td><p>2.7</p></td>
<td><p>4.7</p></td>
<td><p>3.8</p></td>
<td><p>4.9</p></td>
<td><p>0.31</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Myelodysplastic syndromes</p></td>
<td><p>1.3</p></td>
<td><p>3.1</p></td>
<td><p>2.0</p></td>
<td><p>3.1</p></td>
<td><p>0.13</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Other malignant haematopoietic diseases</p></td>
<td><p>0.66</p></td>
<td><p>0.99</p></td>
<td><p>0.82</p></td>
<td><p>1.1</p></td>
<td><p>0.07</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Other specified cancers</p></td>
<td><p>1.1</p></td>
<td><p>1.5</p></td>
<td><p>1.3</p></td>
<td><p>1.6</p></td>
<td><p>0.11</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr class="docutils" />
<div class="section" id="what-about-lookuptable-icd10-entity-dta">
<h2>WHAT about lookuptable_icd10_entity.dta<a class="headerlink" href="#what-about-lookuptable-icd10-entity-dta" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="file://C:/Users/baa/NORDCAN/lookuptable_icd10_entity.dta.csv">file://C:/Users/baa/NORDCAN/lookuptable_icd10_entity.dta.csv</a></p>
<details>
<summary><a>CODE:Listing first 30 records:</a></summary><table class="colwidths-auto docutils align-default" id="id4">
<caption><span class="caption-text">First 39 rows of lookuptable_icd10_entity.dta.csv</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>icd10</p></th>
<th class="head"><p>ent1</p></th>
<th class="head"><p>ent2</p></th>
<th class="head"><p>ent3</p></th>
<th class="head"><p>ent4</p></th>
<th class="head"><p>ent5</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>C00</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C000</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C001</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C002</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C003</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C004</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C005</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C006</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C008</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C009</p></td>
<td><p>10</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C01</p></td>
<td><p>40</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C02</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C020</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C021</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C022</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C023</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C024</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C028</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C029</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C03</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C030</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C031</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C039</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C04</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C040</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C041</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C048</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-odd"><td><p>C049</p></td>
<td><p>20</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
<tr class="row-even"><td><p>C05</p></td>
<td><p>40</p></td>
<td><p>520</p></td>
<td><p>970</p></td>
<td><p>990</p></td>
<td><p>980</p></td>
</tr>
</tbody>
</table>
</details></div>
<div class="section" id="order-of-entities-groups">
<h2>Order of entities groups ?<a class="headerlink" href="#order-of-entities-groups" title="Permalink to this headline">¶</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>      <span class="m">230</span> : <span class="m">227</span> <span class="m">228</span> <span class="m">229</span>
      <span class="m">320</span> : <span class="m">316</span> <span class="m">316-319</span>
      <span class="m">401</span> : <span class="m">444</span>
      <span class="m">402</span> : <span class="m">435</span>
      <span class="m">403</span> : <span class="m">443</span> <span class="m">446</span> <span class="m">447</span> <span class="m">448</span>
      <span class="m">404</span> : <span class="m">451</span> <span class="m">452</span>
      <span class="m">405</span> : <span class="m">452</span> <span class="m">454</span>
      <span class="m">406</span> : <span class="m">450</span> <span class="m">451</span> <span class="m">452</span> <span class="m">454</span>
<span class="hll">      <span class="m">520</span> : <span class="m">10</span> <span class="m">20</span> <span class="m">30</span> <span class="m">40</span> <span class="m">41</span> <span class="m">50</span>
</span><span class="hll">      <span class="m">530</span> : <span class="m">100</span> <span class="m">90</span>
</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>530 : <strong>100</strong> 90</p>
</div>
</div>
<div class="section" id="mapping-of-entities-descriptions-sla-email-22-april-attached-xlsx-files">
<h2>Mapping of entities descriptions (SLA email 22 April attached xlsx files)<a class="headerlink" href="#mapping-of-entities-descriptions-sla-email-22-april-attached-xlsx-files" title="Permalink to this headline">¶</a></h2>
<details>
<summary><a>CODE: nc_get_entitylevels_from_xlsx.do</a></summary><div class="highlight-stata notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">version</span> <span class="m">16.1</span>

<span class="k">clear</span> all<span class="k"></span>
<span class="k">capt log close</span> _all

<span class="k">cd</span> <span class="s">&quot;C:\Users\baa\NORDCAN</span><span class="se">\&quot;</span>

<span class="k">capture erase</span> <span class="s">&quot;Entity_val_lab.do&quot;</span>

<span class="k">log</span> using nc_get_entitylevels_from_xlsx , text<span class="k"> replace</span>

<span class="c1">* unzipfile  Agenda_and_documents_for_the_upcoming_NORDCAN_meeting.zip</span>

<span class="k">qui forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">5</span> {
	
	frame create level<span class="nv">`i&#39;</span>
	
	frame level<span class="nv">`i&#39;</span> {
		
		import excel using <span class="s">&quot;Entity_level</span><span class="nv">`i&#39;</span><span class="s">.xlsx&quot;</span> , firstrow 
<span class="k">		</span>
<span class="k">		capture confirm</span> variable Entity1
<span class="k">		</span>
<span class="k">		if</span> ( _rc <span class="o">==</span> <span class="m">0</span>) { <span class="c1">// fix inconsistency in naming</span>
<span class="k">			</span>
<span class="k">			rename</span> Entity1 Entity_1
<span class="k">			lab var</span> Entity_1 Entity_1
		}
<span class="k">		</span>
<span class="k">		compress</span>
<span class="k">		keep if</span> <span class="o">!</span><span class="nf">mi</span>(Entity_<span class="nv">`i&#39;</span>)
<span class="k">		</span>
<span class="k">		forvalues</span> j = <span class="m">1</span><span class="o">/</span><span class="nv">`=_N&#39;</span> {
<span class="k">			</span>
<span class="k">			lab</span> define Entity_<span class="nv">`i&#39;</span> <span class="nv">`=Entity_`i&#39;[`j&#39;]&#39;</span> <span class="s">&quot;</span><span class="nv">`=Description[`j&#39;]&#39;</span><span class="s">&quot;</span> , add 
		}	
<span class="k">		</span>
<span class="k">		label save</span> Entity_<span class="nv">`i&#39;</span> using <span class="s">&quot;Entity_</span><span class="nv">`i&#39;</span><span class="s">_val_lab.do&quot;</span> ,<span class="k"> replace</span>
<span class="k">		</span>
<span class="k">		capture rename</span> Description Description<span class="nv">`i&#39;</span>
<span class="k">		</span>
<span class="k">		save</span> Entity_<span class="nv">`i&#39;</span> ,<span class="k"> replace</span> 
	}
}

<span class="k">clear</span>
<span class="k">local</span> ents Entity_1 Entity_2 Entity_3 Entity_4 Entity_5<span class="k"></span>
<span class="k">append</span> using <span class="nv">`ents&#39;</span>

<span class="k">forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">5</span> {
<span class="k">	</span>
<span class="k">	do</span> <span class="s">&quot;Entity_</span><span class="nv">`i&#39;</span><span class="s">_val_lab.do&quot;</span>    <span class="c1">// define value label </span>
<span class="k">	lab</span> val Entity_<span class="nv">`i&#39;</span> Entity_<span class="nv">`i&#39;</span> <span class="c1">// apply value label</span>
<span class="k">	</span>
<span class="k">	scalar lab</span> = <span class="nf">fileread</span>(<span class="s">&quot;Entity_</span><span class="nv">`i&#39;</span><span class="s">_val_lab.do&quot;</span>)
<span class="k">	scalar lab</span> = <span class="nf">subinstr</span>(<span class="nf">scalar</span>(lab), <span class="s">&quot;Entity_</span><span class="nv">`i&#39;</span><span class="s">&quot;</span>,<span class="s">&quot;Entity&quot;</span>,.)
<span class="k">	scalar</span> fh = <span class="nf">filewrite</span>(<span class="s">&quot;Entity_val_lab.do&quot;</span>,<span class="k"> scalar</span>(lab),<span class="m">2</span>)
}

<span class="k">gen</span> Entity = <span class="nf">min</span>(<span class="nv">`=subinstr(&quot;`ents&#39;&quot;,&quot; &quot;,&quot;,&quot;,.)&#39;</span>) , before(Entity_1)<span class="k"></span>
<span class="k">isid</span> Entity <span class="k"></span>
<span class="k">sort</span> Entity <span class="k"></span>
<span class="k">run</span> Entity_val_lab<span class="m">.</span>do<span class="k"></span>
<span class="k">lab</span> val Entity Entity<span class="k"></span>
<span class="k">decode</span> Entity,<span class="k"> generate</span>(Entity_description)<span class="k"></span>
<span class="k">order</span> Entity_description, after(Entity)

<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> { <span class="c1">// left adjust str vars display format</span>

<span class="k">	capture confirm</span> string<span class="k"> var</span> <span class="nv">`v&#39;</span>
<span class="k">	</span>
<span class="k">	if</span> ( _rc <span class="o">==</span> <span class="m">0</span> ) {
<span class="k">		</span>
<span class="k">		tempvar</span> tmp
<span class="k">		gen</span> <span class="nv">`tmp&#39;</span> = <span class="nf">strlen</span>(<span class="nv">`v&#39;</span>)
<span class="k">		su</span> <span class="nv">`tmp&#39;</span> , meanonly
<span class="k">		local</span> len = <span class="nv">`r(max)&#39;</span>
<span class="k">		format</span> %<span class="o">-</span><span class="nv">`len&#39;</span>s <span class="nv">`v&#39;</span>
<span class="k">		drop</span> <span class="nv">`tmp&#39;</span> 
	}
}

<span class="k">forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">5</span> { <span class="c1">// save original xlsx to dta file as BLOB (Stata strL) </span>
<span class="k">	</span>
<span class="k">	gen</span> strL source_file_<span class="nv">`i&#39;</span> = <span class="nf">fileread</span>(<span class="s">&quot;Entity_level</span><span class="nv">`i&#39;</span><span class="s">.xlsx&quot;</span>)<span class="k"> in</span> <span class="m">1</span>
<span class="k">	lab var</span> source_file_<span class="nv">`i&#39;</span> <span class="s">&quot;Entity_level</span><span class="nv">`i&#39;</span><span class="s">.xlsx&quot;</span>
}

<span class="k">capture isid</span> Entity_description

<span class="k">if</span> ( _rc <span class="o">&gt;</span> <span class="m">0</span> ) {
<span class="k">	</span>
<span class="k">	tempvar</span> dup
<span class="k">	duplicates</span> tag Entity_description ,<span class="k"> gen</span> (<span class="nv">`dup&#39;</span>)
<span class="k">	list</span> Entity Entity_description<span class="k"> if</span> <span class="nv">`dup&#39;</span> , nolab
}

<span class="k">label</span> data <span class="cs">///</span>
<span class="s">&quot;Entities: email SLA: 22 april Agenda and documents for the upcoming NORDCAN meeting&quot;</span>

<span class="c1">* gen byte level_00 = 1   // 980 All sites</span>
<span class="c1">* gen byte level_01 = 1   // 990 All sites but non-melanoma skin cancer </span>
<span class="c1">* gen byte level_02 = 1   // 970 All sites but non-melanoma skin cancer, breast and prostate </span>

<span class="k">list</span> Entity Entity_description<span class="k"> if</span> <span class="o">!</span><span class="nf">mi</span>(Entity_2)  , nolab clean noobs<span class="k"></span>
<span class="k">list</span> Entity Entity_description<span class="k"> if</span> <span class="o">!</span><span class="nf">mi</span>(Entity_1)  , nolab clean noobs

<span class="k">save</span> NC_entities ,<span class="k"> replace</span>

<span class="k">log close</span>

<span class="k">exit</span>
</pre></div>
</td></tr></table></div>
</details></div>
<div class="section" id="stata-file-with-entities-descriptions">
<h2>Stata file with entities descriptions<a class="headerlink" href="#stata-file-with-entities-descriptions" title="Permalink to this headline">¶</a></h2>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>Contains data from NC_entities<span class="m">.</span>dta
  obs:            <span class="m">90</span>                          Entities: email SLA: <span class="m">22</span> april Agenda and documents<span class="k"> for</span> the upcoming NORDCAN meet
 vars:            <span class="m">18</span>                          <span class="m">28</span> Jun <span class="m">2020</span> <span class="m">22</span>:<span class="m">30</span>
<span class="o">---------------------------------------------------------------------------------------------------------------------------------------</span>
                          storage  <span class="k"> display</span>    value
variable name  <span class="k"> type</span>   <span class="k"> format</span>    <span class="k"> label</span>      variable<span class="k"> label</span>
<span class="o">---------------------------------------------------------------------------------------------------------------------------------------</span>
Entity          double  <span class="nx">%65.0g</span>     Entity
Entity_descri<span class="o">~</span>n str65   <span class="nx">%-65s</span>
Entity_1        int     <span class="nx">%65.0g</span>     Entity_1   Entity_1
Description1    str65   <span class="nx">%-65s</span>                 Description
Comment         str83   <span class="nx">%-83s</span>                 Comment
Entity_2        int     <span class="nx">%45.0g</span>     Entity_2   Entity_2
Description2    str45   <span class="nx">%-45s</span>                 Description
Entity_3        int     <span class="nx">%59.0g</span>     Entity_3   Entity_3
Description3    str59   <span class="nx">%-59s</span>                 Description
Entity_4        int     <span class="nx">%38.0g</span>     Entity_4   Entity_4
Description4    str38   <span class="nx">%-38s</span>                 Description
Entity_5        int     <span class="nx">%10.0g</span>     Entity_5   Entity_5
Description5    str9    <span class="nx">%-9s</span>                  Description
source_file_1   strL    <span class="nx">%9s</span>                   Entity_level1<span class="m">.</span>xlsx
source_file_2   strL    <span class="nx">%9s</span>                   Entity_level2<span class="m">.</span>xlsx
source_file_3   strL    <span class="nx">%9s</span>                   Entity_level3<span class="m">.</span>xlsx
source_file_4   strL    <span class="nx">%9s</span>                   Entity_level4<span class="m">.</span>xlsx
source_file_5   strL    <span class="nx">%9s</span>                   Entity_level5<span class="m">.</span>xlsx
<span class="o">---------------------------------------------------------------------------------------------------------------------------------------</span>
Sorted<span class="k"> by</span>: Entity
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="code-r-nordcan-basicepistats-survival-r">
<h2>Code: R nordcan_basicepistats_survival.R<a class="headerlink" href="#code-r-nordcan-basicepistats-survival-r" title="Permalink to this headline">¶</a></h2>
<details>
<summary><a>CODE: nordcan_basicepistats_survival.R</a></summary><div class="highlight-R notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">#####################################################################################</span>

<span class="c1"># run_stata_rs_cmd_file</span>

<span class="c1">#&#39; NORDCAN survival: run Stata cmd file via shell</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param stata_path </span>
<span class="c1">#&#39; @param stata_exe </span>
<span class="c1">#&#39; @param stata_cmd_file_name </span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @return</span>
<span class="c1">#&#39; @export</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @examples</span>

<span class="n">run_stata_rs_cmd_file</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span>
  
  <span class="n">stata_path</span><span class="p">,</span> 
  <span class="n">stata_exe</span><span class="p">,</span> 
  <span class="n">stata_cmd_file_name</span> <span class="o">=</span> <span class="s">&quot;stata_nordcan_rs_cmd_file.do&quot;</span> 

<span class="p">)</span> <span class="p">{</span>
 
<span class="n">stata_prog</span> <span class="o">=</span> <span class="nf">paste</span><span class="p">(</span><span class="n">stata_path</span><span class="p">,</span> <span class="n">stata_exe</span> <span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Stata need to be forced to start in current dirctory</span>

<span class="n">wd</span> <span class="o">=</span> <span class="nf">getwd</span><span class="p">()</span>

<span class="n">flags</span> <span class="o">=</span> <span class="s">&quot; /e /i &quot;</span>
<span class="n">stata_cmd_file_name</span> <span class="o">&lt;-</span> <span class="nf">paste</span><span class="p">(</span> <span class="n">wd</span> <span class="p">,</span> <span class="n">stata_cmd_file_name</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;/&quot;</span> <span class="p">)</span> 
<span class="n">args</span> <span class="o">&lt;-</span> <span class="nf">paste</span><span class="p">(</span> <span class="n">flags</span><span class="p">,</span> <span class="n">stata_cmd_file_name</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot; &quot;</span> <span class="p">)</span> 

<span class="n">shellcmd</span> <span class="o">&lt;-</span> <span class="nf">paste</span><span class="p">(</span><span class="n">stata_prog</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="p">)</span>  

<span class="nf">message</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">,</span> <span class="s">&quot;Running Stata in batch mode: &quot;</span><span class="p">,</span> <span class="n">shellcmd</span><span class="p">,</span> <span class="s">&quot;\n&quot;</span><span class="p">)</span>

<span class="nf">system2</span><span class="p">(</span><span class="n">stata_prog</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">args</span> <span class="p">)</span>

<span class="nf">message</span><span class="p">(</span><span class="s">&quot;Finnished running Stata cmd file: &quot;</span><span class="p">,</span> <span class="n">stata_cmd_file_name</span><span class="p">)</span>

<span class="p">}</span>

<span class="c1">#####################################################################################</span>


<span class="c1"># function write_stata_nordcan_rs_cmd_file </span>

<span class="c1">#&#39; NORDCAN survival: write Stata cmd file to be run</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @param INFILE a proper NORDCAN survival dataset (CSV, UFT-8) or dta</span>
<span class="c1">#&#39; @param IMPLEMENTATION default Stata stnet </span>
<span class="c1">#&#39; @param ESTIMATOR detault pohar </span>
<span class="c1">#&#39; @param OUTFILE same format as INFILE (CSV, UFT-8) or dta</span>
<span class="c1">#&#39; @param BY </span>
<span class="c1">#&#39; @param IWEIGHT </span>
<span class="c1">#&#39; @param STANDSTRATA </span>
<span class="c1">#&#39; @param stata_cmd_file_name </span>
<span class="c1">#&#39; @param ESTIMAND what is to be estimated</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @return write Stata do file &quot;stata_nordcan_rs_cmd_file.do&quot;</span>
<span class="c1">#&#39; @export OUTFILE same format as INFILE (CSV, UFT-8) or dta</span>
<span class="c1">#&#39;</span>
<span class="c1">#&#39; @examples</span>
<span class="c1">#&#39; </span>

<span class="n">write_stata_nordcan_rs_cmd_file</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span>
  
  <span class="n">INFILE</span><span class="p">,</span> 
  <span class="n">OUTFILE</span><span class="p">,</span> 
  <span class="n">ESTIMAND</span><span class="o">=</span><span class="s">&quot;net survival&quot;</span><span class="p">,</span> <span class="c1"># what is to be estimated NOT IN USE  </span>
  <span class="n">ESTIMATOR</span> <span class="o">=</span> <span class="s">&quot;pohar&quot;</span><span class="p">,</span>
  <span class="n">IMPLEMENTATION</span> <span class="o">=</span> <span class="s">&quot;stnet&quot;</span><span class="p">,</span>
  <span class="n">BY</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>  
  <span class="n">IWEIGHT</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>      
  <span class="n">STANDSTRATA</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
  <span class="n">stata_cmd_file_name</span> <span class="o">=</span> <span class="s">&quot;stata_nordcan_rs_cmd_file.do&quot;</span>
  
<span class="p">){</span>

<span class="nf">library</span><span class="p">(</span><span class="s">&quot;stringr&quot;</span><span class="p">)</span> 

<span class="n">WD</span> <span class="o">=</span> <span class="nf">getwd</span><span class="p">()</span>

<span class="n">stata_do_file_content</span> <span class="o">&lt;-</span>
  
<span class="s">&quot;</span>
<span class="s">cd WD </span>

<span class="s">adopath ++ ./Stata/ado/</span>

<span class="s">stata_nordcan_rs , ///</span>
<span class="s">    infile(INFILE) /// </span>
<span class="s">    outfile(OUTFILE) /// </span>
<span class="s">    implementation(IMPLEMENTATION) ///</span>
<span class="s">    estimator(ESTIMATOR) ///</span>
<span class="s">    by(BY) ///</span>
<span class="s">    iweight(IWEIGHT) ///</span>
<span class="s">    standstrata(STANDSTRATA)</span>
<span class="s">&quot;</span>

<span class="n">stata_do_file_content</span> <span class="o">&lt;-</span> <span class="nf">str_replace_all</span><span class="p">(</span> 

  <span class="n">stata_do_file_content</span><span class="p">,</span>  
	<span class="nf">c</span><span class="p">(</span>
	  
	  <span class="s">&quot;WD&quot;</span> <span class="o">=</span> <span class="n">WD</span><span class="p">,</span>
	  <span class="s">&quot;INFILE&quot;</span> <span class="o">=</span> <span class="n">INFILE</span><span class="p">,</span> 
	  <span class="s">&quot;OUTFILE&quot;</span> <span class="o">=</span> <span class="n">OUTFILE</span><span class="p">,</span> 
	  <span class="s">&quot;IMPLEMENTATION&quot;</span> <span class="o">=</span> <span class="n">IMPLEMENTATION</span><span class="p">,</span>
	  <span class="s">&quot;ESTIMATOR&quot;</span> <span class="o">=</span> <span class="n">ESTIMATOR</span><span class="p">,</span>
	  <span class="s">&quot;BY&quot;</span> <span class="o">=</span> <span class="n">BY</span><span class="p">,</span>
	  <span class="s">&quot;IWEIGHT&quot;</span> <span class="o">=</span> <span class="n">IWEIGHT</span><span class="p">,</span>
	  <span class="s">&quot;STANDSTRATA&quot;</span> <span class="o">=</span> <span class="n">STANDSTRATA</span>
	<span class="p">)</span>
<span class="p">)</span>

<span class="nf">cat</span><span class="p">(</span><span class="n">stata_do_file_content</span><span class="p">,</span>
	<span class="n">file</span> <span class="o">=</span> <span class="n">stata_cmd_file_name</span><span class="p">,</span> 
	<span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;\r\n&quot;</span>
<span class="p">)</span>

<span class="nf">message</span><span class="p">(</span><span class="s">&quot;\n&quot;</span><span class="p">,</span> <span class="s">&quot;generated Stata cmd file: &quot;</span><span class="p">,</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">,</span> <span class="n">stata_cmd_file_name</span> <span class="p">,</span> <span class="s">&quot;\&quot;&quot;</span> <span class="p">)</span>

<span class="nf">message</span><span class="p">(</span><span class="n">stata_do_file_content</span><span class="p">)</span>

<span class="n">return_list</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span>
  
  <span class="n">INFILE</span><span class="p">,</span> 
  <span class="n">OUTFILE</span><span class="p">,</span> 
  <span class="n">stata_cmd_file_name</span>
<span class="p">)</span>

<span class="nf">return</span><span class="p">(</span><span class="n">return_list</span><span class="p">)</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</details></div>
<div class="section" id="code-stata-stata-nordcan-rs-ado">
<h2>Code: Stata stata_nordcan_rs.ado<a class="headerlink" href="#code-stata-stata-nordcan-rs-ado" title="Permalink to this headline">¶</a></h2>
<details>
<summary><a>CODE: stata_nordcan_rs.ado</a></summary><div class="highlight-stata notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll"><span class="c1">* stata_nordcan_rs main routine </span>
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll">
</span><span class="hll"><span class="k">prog</span> define stata_nordcan_rs , <span class="cs">///</span>
</span><span class="hll">	nclass <span class="cs">/// </span>
</span><span class="hll">	properties( nordcan estimation )
</span><span class="hll"><span class="c1">	</span>
</span><span class="hll"><span class="c1">*! version 0.2 POC/MWE </span>
</span><span class="hll"><span class="c1">*! stata_nordcan_rs defines fup and estimate ns</span>
</span><span class="hll"><span class="c1">*! import a proper NORDCAN survival data file </span>
</span><span class="hll"><span class="c1">*! estimate rs and export results</span>
</span><span class="hll"><span class="c1">*! sub nc_stset </span>
</span><span class="hll"><span class="c1">*! sub nc_stnet</span>
</span><span class="hll"><span class="c1">*! sub nc_strs</span>
</span><span class="hll">
</span><span class="hll"><span class="k">version</span> <span class="m">14.2</span>  <span class="cs">/// test on 14.2, 15, 16.1</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll"><span class="c1">* define project directories</span>
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll">
</span><span class="hll"><span class="k">local</span> datadir .<span class="o">/</span>data<span class="o">/</span><span class="k"></span>
</span><span class="hll"><span class="k">local</span> resdir  .<span class="o">/</span>results<span class="o">/</span><span class="k"></span>
</span><span class="hll"><span class="k">local</span> logdir  .<span class="o">/</span>logfiles<span class="o">/</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll"><span class="c1">* parse arguments using Stata syntax command</span>
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll">
</span><span class="hll"><span class="k">syntax</span> , <span class="cs">///</span>
</span><span class="hll"><span class="k">	infile</span>(string)                   <span class="cs">/// REQUIRED </span>
</span><span class="hll"><span class="k">	outfile</span>(string)                  <span class="cs">/// REQUIRED  </span>
</span><span class="hll">	[ lifetable(string) ]            <span class="cs">/// REQUIRED </span>
</span><span class="hll">	[ implementation(string) ]       <span class="cs">/// [ OPTIONAL ] stnet, strs</span>
</span><span class="hll">	[ estimator(string) ]            <span class="cs">/// [ OPTIONAL ] pohar, </span>
</span><span class="hll">	[<span class="k"> by</span>(string) ]                   <span class="cs">/// [ OPTIONAL ] </span>
</span><span class="hll">	[ iweight(string) ]              <span class="cs">/// [ OPTIONAL ] weights (sum==1)</span>
</span><span class="hll">	[ standstrata(string)]           <span class="cs">/// [ OPTIONAL ] weight strata</span>
</span><span class="hll">	[ stata_cmd_options(string asis) ]       
</span><span class="hll"><span class="c1">	</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">*  default values </span>
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`implementation&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local</span> implementation = <span class="s">&quot;stnet&quot;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`estimator&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local</span> estimator = <span class="s">&quot;pohar&quot;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`by&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local by</span> = <span class="s">&quot;ICD10gr sex period&quot;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`iweight&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local</span> iweight = <span class="s">&quot;nc_s_agegroup_weights_ICSS_1&quot;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`standstrata&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local</span> standstrata = <span class="s">&quot;nc_s_agegroup_ICSS_1&quot;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`lifetable&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll">
</span><span class="hll"><span class="k">	local</span> lifetable = <span class="s">&quot;</span><span class="nv">`datadir&#39;</span><span class="s">Norway_2018_national_general_population.dta&quot;</span>
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	confirm file</span> <span class="s">`&quot;</span><span class="nv">`lifetable&#39;</span><span class="s">&quot;&#39;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`logfilename&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> ) {
</span><span class="hll">
</span><span class="hll"><span class="k">	local</span> logname =  <span class="nf">subinstr</span>(<span class="s">`&quot;</span><span class="nv">`logfilename&#39;</span><span class="s">&quot;&#39;</span>, <span class="s">&quot;.log&quot;</span>, <span class="s">&quot;&quot;</span>, <span class="m">1</span> )
</span><span class="hll"><span class="k">	local</span> logfilename = <span class="s">&quot;</span><span class="nv">`logdir&#39;</span><span class="s">stata_nordcan_rs.log&quot;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll">
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll"><span class="c1">* start codeocean TESTING ONLY</span>
</span><span class="hll"><span class="c1">*</span>
</span><span class="hll"><span class="c1">* os linux </span>
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="nf">c</span>(pwd) <span class="o">==</span> <span class="s">&quot;/root/capsule/code&quot;</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local</span> datadir = <span class="s">&quot;/root/capsule/data/&quot;</span>
</span><span class="hll"><span class="k">	local</span> resdir = <span class="s">&quot;/root/capsule/results/&quot;</span>
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	local infile</span> = <span class="s">&quot;</span><span class="nv">`datadir&#39;`infile&#39;</span><span class="s">&quot;</span>
</span><span class="hll"><span class="k">	local outfile</span> = <span class="s">&quot;</span><span class="nv">`resdir&#39;`outfile&#39;</span><span class="s">&quot;</span>
</span><span class="hll">} 
</span><span class="hll"><span class="c1">   </span>
</span><span class="hll"><span class="c1">* end codeocean TESTING ONLY</span>
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll"><span class="c1">* start log of session</span>
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll">
</span><span class="hll"><span class="k">capture log close</span> <span class="nv">`logname&#39;</span>  <span class="k"></span>
</span><span class="hll"><span class="k">log</span> using <span class="s">&quot;</span><span class="nv">`logfilename&#39;</span><span class="s">&quot;</span> , name(<span class="nv">`logname&#39;</span>) text<span class="k"> replace</span> 
</span><span class="hll">
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll"><span class="c1">* read a proper NORDCAN survivalfile. Format text CSV &quot;;&quot; UTF-8</span>
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll">
</span><span class="hll"><span class="k">local</span> source = lower(<span class="nf">substr</span>(<span class="s">&quot;</span><span class="nv">`infile&#39;</span><span class="s">&quot;</span>,<span class="o">-</span><span class="m">4</span>,.)) 
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`source&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;.csv&quot;</span> ) {
</span><span class="hll">
</span><span class="hll">	nc_rs_import_csv ,<span class="k"> infile</span>(<span class="nv">`infile&#39;</span>)
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">else if</span> ( <span class="s">&quot;</span><span class="nv">`source&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;.dta&quot;</span> )  {
</span><span class="hll">
</span><span class="hll"><span class="k">	use</span> <span class="nv">`infile&#39;</span> ,<span class="k"> clear</span>
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">	confirm</span> variables <span class="nv">`by&#39;</span>
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll"><span class="c1">* 1.A define follow-up ( _t0, _t, _d )</span>
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll">
</span><span class="hll">nc_stset <span class="c1">// run stset using NORDCAN spec </span>
</span><span class="hll">
</span><span class="hll"><span class="k">capture noi assert</span> _st
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( _rc <span class="o">&gt;</span> <span class="m">0</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">   display as err</span> <span class="s">&quot;ERROR: defining follow-up&quot;</span>
</span><span class="hll"><span class="k">   exit</span>			
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll"><span class="c1">* 1.B verify data in all strata at start fup and weights sum to one </span>
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll">
</span><span class="hll"><span class="k">capture noi</span> nc_s_data_chk_strata , <span class="cs">/// </span>
</span><span class="hll"><span class="k">	by</span>(<span class="nv">`by&#39;</span>) <span class="cs">///</span>
</span><span class="hll">	iweight(<span class="nv">`iweight&#39;</span>) <span class="cs">/// </span>
</span><span class="hll">	standstrata(<span class="nv">`standstrata&#39;</span>) <span class="cs">///  </span>
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( _rc <span class="o">&gt;</span> <span class="m">0</span> ) {
</span><span class="hll"><span class="k">	</span>
</span><span class="hll"><span class="k">   display as err</span> <span class="s">&quot;ERROR: validating age strata&quot;</span>
</span><span class="hll"><span class="k">   exit</span>			
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll"><span class="c1">* 2. estimate ns using stnet or strs</span>
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`implementation&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;stnet&quot;</span> ) {
</span><span class="hll">		
</span><span class="hll">	nc_stnet , <span class="cs">///</span>
</span><span class="hll">		lifetable(<span class="nv">`lifetable&#39;</span>) <span class="cs">///</span>
</span><span class="hll"><span class="k">		outfile</span>(<span class="nv">`outfile&#39;</span>)
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="k">else if</span> ( <span class="s">&quot;</span><span class="nv">`implementation&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;strs&quot;</span> ) {
</span><span class="hll">		
</span><span class="hll">	nc_strs , <span class="cs">///</span>
</span><span class="hll">		lifetable(<span class="nv">`lifetable&#39;</span>) <span class="cs">///</span>
</span><span class="hll"><span class="k">		outfile</span>(<span class="nv">`outfile&#39;</span>) <span class="cs">///</span>
</span><span class="hll">		estimator(<span class="nv">`estimator&#39;</span>)
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="c1">**********************************************************************</span>
</span><span class="hll"><span class="c1">* 3. transform to percent, format , export, adding meta data etc...</span>
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll">
</span><span class="hll"><span class="c1">* nc_rs_format_export VERY PRELIMINARY without formating etc</span>
</span><span class="hll">
</span><span class="hll"><span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`source&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;.csv&quot;</span> ) { <span class="cs">/// assuming CSV in -&gt; CSV out </span>
</span><span class="hll">	
</span><span class="hll">	nc_rs_format_export ,<span class="k"> outfile</span>(<span class="nv">`outfile&#39;</span>)
</span><span class="hll">}
</span><span class="hll">
</span><span class="hll"><span class="c1">********************************************************************** </span>
</span><span class="hll">
</span><span class="hll"><span class="k">log close</span> <span class="nv">`logname&#39;</span> <span class="c1">// close session log</span>
</span><span class="hll">
</span><span class="hll"><span class="k">end</span> <span class="c1">// main: stata_nordcan_rs</span>
</span>
<span class="c1">********************************************************************** </span>
<span class="c1">*</span>
<span class="c1">* stata_nordcan_rs subroutines</span>
<span class="c1">*</span>
<span class="c1">* nc_stset : define follow-up ( _t0, _t , _d0 ) using NORDCAN spec.</span>
<span class="c1">* nc_stnet : run stnet.ado using NORDCAN spec.</span>
<span class="c1">* nc_strs  : run strs.ado using NORDCAN spec.</span>
<span class="c1">* nc_rs_import_csv : </span>
<span class="c1">* nc_rs_format_export :</span>
<span class="c1">* nc_s_data_chk_strata : verify/mark/delete if agegr with sero obs </span>
<span class="c1">*</span>
<span class="c1">**********************************************************************</span>
{ <span class="c1">// stata_nordcan_rs subroutines</span>
{ <span class="c1">// sub nc_stset</span>
<span class="k"> </span>
<span class="k">prog</span> define nc_stset , nclass 

#delim ;

<span class="k">scalar</span> stsetcmd = 

<span class="k">trim</span>(itrim(<span class="nf">ustrregexra</span>(

<span class="s">`&quot;</span>

<span class="s">stset time ,</span>

<span class="s">	fail(death)              /* failure indicator */</span>
<span class="s">	origin(time diag_date)   /* define time == 0  */</span>
<span class="s">	enter(time diag_date)    /* define time of entry */</span>
<span class="s">	scale(365.25)            /* scale (date days since epoche) to years */</span>
<span class="s">	id(pid)                  /* subject pseudo ID variable */</span>

<span class="s">&quot;&#39;</span> , <span class="s">&quot;\/\*.+?\*\/&quot;</span>, <span class="s">&quot;&quot;</span> <span class="cm">/* strip of comments */</span> )))
;
#delim cr 

<span class="k">mata</span>: nc_stset_cmd = st_strscalar(<span class="s">&quot;stsetcmd&quot;</span>)<span class="k"></span>
<span class="k">mata</span>: stata(nc_stset_cmd) 

stdescribe
<span class="k"> </span>
<span class="k">end</span> <span class="c1">// define nc_stset</span>

}

{ <span class="c1">// sub nc_stnet</span>

<span class="k">prog</span> define nc_stnet , sclass

<span class="k">syntax</span> , <span class="cs">///</span>
	lifetable(string) <span class="cs">/// REQUIRED name of lifetable file</span>
<span class="k">	outfile</span>(string) <span class="cs">/// REQUIRED name of outfile </span>
	[iweight(varname)] <span class="cs">/// OPTIONAL weights age std variable name</span>
	[standstrata(varname)] <span class="cs">/// OPTIONAL age std strata variable name</span>
	[brenner]  <span class="cs">/// OPTIONAL Brenner weighting</span>
<span class="c1">	</span>
<span class="c1">**********************************************************************</span>

<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`by&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>          <span class="k"> local by</span> = <span class="s">&quot;ICD10gr sex period&quot;</span><span class="k"></span>
<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`breaks&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>      <span class="k"> local</span> breaks = <span class="s">&quot;0(</span><span class="nv">`=1/12&#39;</span><span class="s">)5&quot;</span><span class="k"></span>
<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`birthdate&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>   <span class="k"> local</span> birthdate = <span class="s">&quot;dob&quot;</span><span class="k"></span>
<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`diagdate&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>  	 <span class="k"> local</span> diagdate = <span class="s">&quot;diag_date&quot;</span><span class="k"></span>
<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`mergeby&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>     <span class="k"> local</span> mergeby = <span class="s">&quot;_year sex _age&quot;</span><span class="k"></span>
<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`survprob&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>    <span class="k"> local</span> survprob = <span class="s">&quot;prob&quot;</span>

<span class="c1">**********************************************************************</span>

<span class="k">confirm file</span> <span class="s">`&quot;</span><span class="nv">`lifetable&#39;</span><span class="s">&quot;&#39;</span>

<span class="k">local</span> lifetable = <span class="nf">subinstr</span>(<span class="s">`&quot;</span><span class="nv">`lifetable&#39;</span><span class="s">&quot;&#39;</span>, <span class="s">&quot;.dta&quot;</span>, <span class="s">&quot;&quot;</span>, <span class="m">1</span> )

<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`brenner&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span>     <span class="k"> local</span> brenner = <span class="s">&quot;brenner&quot;</span>

<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`iweight&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> {
<span class="k">	</span>
<span class="k">	local</span> iweight = <span class="s">&quot;nc_s_agegroup_weights_ICSS_1&quot;</span>
<span class="k">	local</span> iweight_arg = <span class="s">&quot; [ iweight = </span><span class="nv">`iweight&#39;</span><span class="s"> ] &quot;</span>
}

<span class="k">if</span> <span class="s">&quot;</span><span class="nv">`standstrata&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;&quot;</span> {
<span class="k">	</span>
<span class="k">	local</span> standstrata = <span class="s">&quot;nc_s_agegroup_ICSS_1&quot;</span>
<span class="k">	local</span> standstrata_arg = <span class="s">&quot; standstrata(</span><span class="nv">`standstrata&#39;</span><span class="s">)&quot;</span>
}

<span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`brenner&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;brenner&quot;</span> ) {
<span class="k">	</span>
<span class="k">	confirm</span> variable <span class="nv">`iweight&#39;</span>
<span class="k">	confirm</span> variable <span class="nv">`standstrata&#39;</span>
<span class="k">	confirm</span> variable weight_err
<span class="k">	assert</span> <span class="nf">inlist</span>(weight_err,<span class="m">0</span>,<span class="m">1</span>)
<span class="k">	</span>
<span class="k">	keep if</span> weight_err <span class="o">==</span> <span class="m">0</span>
}

#delim ;

<span class="k">scalar</span> stnetcmd = 

<span class="k">trim</span>(itrim(

<span class="s">`&quot;</span>

<span class="s">stnet using &quot;</span><span class="nv">`lifetable&#39;</span><span class="s">&quot; </span><span class="nv">`iweight_arg&#39;</span><span class="s">   , </span>
<span class="s">	</span><span class="nv">`standstrata_arg&#39;</span><span class="s"> </span>
<span class="s">	</span><span class="nv">`brenner&#39;</span><span class="s">						    						</span>
<span class="s">	by(</span><span class="nv">`by&#39;</span><span class="s">)                             </span>
<span class="s">	breaks(</span><span class="nv">`breaks&#39;</span><span class="s">)                     </span>
<span class="s">	birthdate(</span><span class="nv">`birthdate&#39;</span><span class="s">)              </span>
<span class="s">	diagdate(</span><span class="nv">`diagdate&#39;</span><span class="s">)                </span>
<span class="s">	mergeby(</span><span class="nv">`mergeby&#39;</span><span class="s">)                   </span>
<span class="s">	survprob(</span><span class="nv">`prob&#39;</span><span class="s">)                     </span>
<span class="s">	saving(</span><span class="nv">`outfile&#39;</span><span class="s">, replace)          </span>
<span class="s">	notab  </span>
<span class="s">	</span>
<span class="s">&quot;&#39;</span>
))
;
#delim cr

<span class="k">mata</span>: nc_stnet_cmd = st_strscalar(<span class="s">&quot;stnetcmd&quot;</span>)<span class="k"></span>
<span class="k">mata</span>: stata(nc_stnet_cmd) <span class="c1">// run stnet </span>
nc_outfile_add_meta_data,<span class="k"> outfile</span>(<span class="nv">`outfile&#39;</span>)

<span class="k">end</span> <span class="c1">// nc_stnet</span>

}

{ <span class="c1">// sub nc_strs</span>

<span class="k">prog</span> define nc_strs , nclass

<span class="k">syntax</span> , <span class="cs">///</span>
	lifetable(string) <span class="cs">/// REQUIRED name of lifetable file</span>
<span class="k">	outfile</span>(string) <span class="cs">/// REQUIRED name of outfile</span>
	estimator(string) 
<span class="k">	</span>
<span class="k">if</span> ( <span class="s">&quot;</span><span class="nv">`estimator&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;pohar&quot;</span> ) {
<span class="k">	</span>
<span class="k">	local</span> pohar = <span class="s">&quot;pohar&quot;</span>
}
<span class="k">	</span>
<span class="k">local by</span> = <span class="s">&quot;ICD10gr sex period&quot;</span><span class="k"></span>
<span class="k">local</span> breaks = <span class="s">&quot;0(</span><span class="nv">`=1/12&#39;</span><span class="s">)5&quot;</span><span class="k"></span>
<span class="k">local</span> dob = <span class="s">&quot;dob&quot;</span><span class="k"></span>
<span class="k">local</span> diagdate = <span class="s">&quot;diag_date&quot;</span><span class="k"></span>
<span class="k">local</span> diagage = <span class="s">&quot;age&quot;</span>

<span class="k">capt gen</span> diagyear = <span class="nf">year</span>(<span class="nv">`diagdate&#39;</span>)<span class="k"></span>
<span class="k">local</span> diagyear = <span class="s">&quot;diagyear&quot;</span>

#delim ;

<span class="k">scalar</span> strscmd = 

<span class="k">trim</span>(itrim(

<span class="s">`&quot;</span>

<span class="s">strs using &quot;</span><span class="nv">`lifetable&#39;</span><span class="s">&quot; ,</span>

<span class="s">	ht</span>
<span class="s">	</span><span class="nv">`pohar&#39;</span><span class="s"></span>
<span class="s">	by(</span><span class="nv">`by&#39;</span><span class="s">) </span>
<span class="s">	breaks(</span><span class="nv">`breaks&#39;</span><span class="s">) </span>
<span class="s">	diagage(</span><span class="nv">`diagage&#39;</span><span class="s">) </span>
<span class="s">	diagyear(</span><span class="nv">`diagyear&#39;</span><span class="s">)</span>
<span class="s">	mergeby(_year sex _age) </span>
<span class="s">	survprob(prob)</span>
<span class="s">	savgroup(</span><span class="nv">`outfile&#39;</span><span class="s">, replace)</span>
<span class="s">	notab</span>

<span class="s">&quot;&#39;</span>
))
;
#delim cr

<span class="k">mata</span>: nc_strs_cmd = st_strscalar(<span class="s">&quot;strscmd&quot;</span>)

<span class="k">mata</span>: stata(nc_strs_cmd) <span class="c1">// run strs</span>

nc_outfile_add_meta_data,<span class="k"> outfile</span>(<span class="nv">`outfile&#39;</span>)

<span class="k">end</span> <span class="c1">// nc_strs</span>

}


{ <span class="c1">// nc_rs_import_csv</span>

<span class="k">prog</span> define nc_rs_import_csv , nclass

<span class="k">syntax</span> ,<span class="k"> infile</span>(string) 

import delimited using <span class="s">&quot;</span><span class="nv">`infile&#39;</span><span class="s">&quot;</span> , <span class="cs">///</span>
	delimiter(<span class="s">&quot;;&quot;</span>) <span class="cs">///</span>
	encoding(<span class="s">&quot;UTF-8&quot;</span>) <span class="cs">/// </span>
	case(preserve) <span class="cs">///</span>
<span class="k">	clear</span>
<span class="k">	</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	</span>
<span class="k">	capture confirm</span> string<span class="k"> var</span> <span class="nv">`v&#39;</span> 
<span class="k">		</span>
<span class="k">	if</span> ( _rc <span class="o">==</span> <span class="m">0</span> ) {

<span class="k">		if</span> ( <span class="nf">strlen</span>(<span class="nv">`v&#39;</span>) <span class="o">==</span> <span class="m">10</span> ) {
<span class="k">	 </span>
<span class="k">			rename</span> <span class="nv">`v&#39;</span> temp
<span class="k">			gen</span> <span class="nv">`v&#39;</span> = <span class="nf">date</span>(temp, <span class="s">&quot;YMD&quot;</span>)
<span class="k">			format</span> <span class="nv">`v&#39;</span> <span class="nx">%td</span>
<span class="k">			drop</span> temp
		} 
	}
}	
<span class="k">	</span>
<span class="k">end</span> <span class="c1">// nc_rs_import_csv 	</span>
	
}

{ <span class="c1">// nc_rs_format_export VERY PRELIMINARY without formating etc</span>

<span class="k">prog</span> define nc_rs_format_export , nclass

<span class="k">syntax</span> ,<span class="k"> outfile</span>(string)

<span class="k">use</span> <span class="nv">`outfile&#39;</span><span class="k"> if end</span> <span class="o">==</span> <span class="m">5</span> ,<span class="k"> clear</span>

<span class="c1">* TODO:</span>
<span class="c1">* </span>
<span class="c1">* 	convert to percent</span>
<span class="c1">* 	select observarions and variables</span>
<span class="c1">* 	rename variables</span>
<span class="c1">* 	add display format </span>

export delimited using <span class="nv">`outfile&#39;</span> , <span class="cs">/// std encoding UTF-8</span>
	delimiter(<span class="s">&quot;;&quot;</span>) <span class="cs">///</span>
<span class="k">	replace</span>
<span class="k">	</span>
<span class="k">end</span>  <span class="c1">// nc_rs_format_export</span>

}

{ <span class="c1">// nc_s_data_chk_strata</span>

<span class="k">prog</span> define nc_s_data_chk_strata , nclass

<span class="k">syntax</span> ,                 <span class="cs">///</span>
<span class="k">	by</span>(varlist)          <span class="cs">///  </span>
	iweight(varname)     <span class="cs">///</span>
	standstrata(varname) <span class="cs">///  </span>

<span class="k">quietly</span> {
<span class="c1">	</span>

<span class="c1">* verify : weights sum to on within life-table strata (by)  </span>
<span class="k"> </span>
<span class="k">tempvar</span> chkbrw agegr

<span class="k">bysort</span> <span class="nv">`by&#39;</span> <span class="nv">`standstrata&#39;</span> :<span class="k"> gen</span> <span class="nv">`chkbrw&#39;</span> = <span class="nv">`iweight&#39;</span><span class="k"> if</span> ( _n <span class="o">==</span> <span class="m">1</span> )<span class="k"></span>
<span class="k">by</span> <span class="nv">`by&#39;</span> :<span class="k"> replace</span> <span class="nv">`chkbrw&#39;</span> =<span class="k"> sum</span>(<span class="nv">`chkbrw&#39;</span>)<span class="k"></span>
<span class="k">by</span> <span class="nv">`by&#39;</span> :<span class="k"> generate</span> byte weight_err = <span class="nf">round</span>(<span class="nv">`chkbrw&#39;</span>[_N], <span class="m">0.01</span>) <span class="o">!=</span> <span class="m">1</span> <span class="k"></span>
<span class="k">drop</span> <span class="nv">`chkbrw&#39;</span>

<span class="c1">* mark life-table strata (`by&#39;) without observations  </span>

<span class="k">assert</span> <span class="nf">inrange</span>(<span class="nv">`standstrata&#39;</span>,<span class="m">1</span> ,<span class="m">9</span>)<span class="k"></span>
<span class="k">levelsof</span> <span class="nv">`standstrata&#39;</span> ,<span class="k"> local</span>(strata)

<span class="k">generate</span> no_obs_in_strata = <span class="cs">///</span>
<span class="k">	trim</span>(<span class="nf">subinstr</span>(<span class="s">&quot;</span><span class="nv">`strata&#39;</span><span class="s">&quot;</span>,<span class="s">&quot; &quot;</span>,<span class="s">&quot;&quot;</span>,.))<span class="k"> if</span> ( weight_err )    

<span class="c1">* report agegroup with no observations </span>
<span class="k">	</span>
<span class="k">by</span> <span class="nv">`by&#39;</span> :<span class="k"> replace</span> no_obs_in_strata = <span class="cs">///</span>
				<span class="nf">subinstr</span>(no_obs_in_strata[_n<span class="m">-1</span>], <span class="cs">///</span>
					<span class="nf">strofreal</span>(<span class="nv">`standstrata&#39;</span>), <span class="s">&quot; &quot;</span>, . ) <span class="cs">///</span>
<span class="k">						if</span> ( weight_err <span class="o">&amp;</span> _n <span class="o">&gt;</span> <span class="m">1</span> ) 
<span class="k">						</span>
<span class="k">by</span> <span class="nv">`by&#39;</span> :<span class="k"> replace</span> no_obs_in_strata = <span class="s">&quot;&quot;</span><span class="k"> if</span> ( weight_err <span class="o">&amp;</span> _n <span class="o">&lt;</span> _N )   

<span class="k">noi di as err</span> _n _n <span class="cs">/// </span>
<span class="s">&quot;Weights (</span><span class="nv">`iweight&#39;</span><span class="s">) does not sum to 1.&quot;</span> _n <span class="cs">/// </span>
<span class="s">&quot;Age stratum (</span><span class="nv">`standstrata&#39;</span><span class="s">) lacking in (no_obs_in_strata):&quot;</span> 

<span class="k">levelsof</span> nc_s_agegroup_ICSS_1_str , <span class="k"> local</span>(age_span)

<span class="k">local</span> i = <span class="m">0</span> 

<span class="k">foreach</span> age<span class="k"> in</span> <span class="nv">`: list clean age_span &#39;</span> {
<span class="k">	</span>
<span class="k">	local</span> <span class="o">++</span>i  
<span class="k">	</span>
<span class="k">	gen s</span><span class="nv">`i&#39;</span> = <span class="s">&quot;</span><span class="nv">`age&#39;</span><span class="s">&quot;</span><span class="k"> if</span> <span class="nf">substr</span>(no_obs_in_strata,<span class="nv">`i&#39;</span>,<span class="m">1</span>) <span class="o">==</span> <span class="s">&quot;</span><span class="nv">`i&#39;</span><span class="s">&quot;</span> 
<span class="k">	</span>
<span class="k">	count if trim</span>(s<span class="nv">`i&#39;</span>) <span class="o">==</span> <span class="s">&quot;&quot;</span>  
<span class="k">	</span>
<span class="k">	if</span> ( <span class="nf">r</span>(N) <span class="o">==</span>  _N ) {
<span class="k">		</span>
<span class="k">		drop s</span><span class="nv">`i&#39;</span>  
	}
}

<span class="k">noi list</span> <span class="nv">`by&#39;</span> no_obs_in_strata<span class="k"> s</span>?<span class="k"> if</span> <span class="o">!</span><span class="nf">mi</span>(no_obs_in_strata), <span class="cs">///</span>
	abbr(<span class="m">32</span>) noobs 

} <span class="c1">// quietly</span>

<span class="k">end</span>  <span class="c1">// nc_s_data_chk_strata</span>
} 


{ <span class="c1">// nc_outfile_add_meta_data</span>
<span class="k">	</span>
<span class="k">prog</span> define nc_outfile_add_meta_data , nclass

<span class="k">syntax</span> ,<span class="k"> outfile</span>(string)

<span class="k">use</span> <span class="nv">`outfile&#39;</span> ,<span class="k"> clear</span>

<span class="c1">* get and reset dta characteristics</span>

<span class="k">mata</span>: st_local(<span class="s">&quot;char_dta&quot;</span>, invtokens(st_dir(<span class="s">&quot;char&quot;</span>, <span class="s">&quot;_dta&quot;</span>, <span class="s">&quot;*&quot;</span>)&#39;))
<span class="k"> </span>
<span class="k"> foreach char</span> of<span class="k"> local</span> char_dta {
<span class="k"> 	</span>
<span class="k">	char</span> _dta[<span class="nv">`char&#39;</span>]	
 }

<span class="c1">* add dta characteristics</span>

<span class="k">capture di</span> strscmd 

<span class="k">if</span> ( _rc <span class="o">!=</span> <span class="m">111</span> ) {
<span class="k">	</span>
<span class="k">	char</span> define _dta[strs] <span class="nv">`=strscmd&#39;</span>
}	

<span class="k">capture di</span> stnetcmd 

<span class="k">if</span> ( _rc <span class="o">!=</span> <span class="m">111</span> ) {
<span class="k">	</span>
<span class="k">	char</span> define _dta[stnet] <span class="nv">`=stnetcmd&#39;</span>
}	

<span class="k">char</span> define _dta[stset] <span class="nv">`=stsetcmd&#39;</span>

<span class="k">save</span> <span class="nv">`outfile&#39;</span> ,<span class="k"> replace</span> 

<span class="k">end</span>
}

} <span class="c1">// stata_nordcan_rs subroutines</span>

<span class="k">exit</span>
</pre></div>
</td></tr></table></div>
</details></div>
</div>
<hr class="docutils" />
<div class="section" id="r-package-nordcansurvival">
<h1>R package nordcansurvival<a class="headerlink" href="#r-package-nordcansurvival" title="Permalink to this headline">¶</a></h1>
<div class="section" id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>provide survival statistics comparable between countries and over time</p></li>
<li><p>primary work-flow: <em>automated/batch</em> within the NORDCAN R-package</p></li>
<li><p><em>documented</em>: methods/code/results/metadata, including automated logging</p></li>
<li><p><strong>easy to maintain and extend ( by CRN survival group )</strong></p></li>
<li><p><strong>can be used standalone in R</strong></p></li>
<li><p><strong>can be used *the same way* from R and Stata</strong></p></li>
</ul>
</div></blockquote>
<hr class="docutils" />
<div class="section" id="nordcansurvival-should-provide-functions-for">
<h3>nordcansurvival should provide functions for<a class="headerlink" href="#nordcansurvival-should-provide-functions-for" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p>any extra survival prepocessing</p></li>
<li><p>statistics</p></li>
<li><p>export of statistics, detailed survival statistics, meta-data, log-files</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nordcanpackages</span>
                            <span class="o">+----------------------------+</span>
<span class="n">nordcanepistats</span>             <span class="o">|</span> <span class="n">nordcansurvival</span>            <span class="o">|</span>
       <span class="o">|</span>                    <span class="o">+----------------------------+</span>
       <span class="o">|</span>                    <span class="o">|</span>  <span class="n">surv_preprocessing</span><span class="p">()</span>      <span class="o">|</span>  <span class="n">nordcansurvival_surv_preprossessing</span><span class="o">.</span><span class="n">r</span>
       <span class="o">|</span>                    <span class="o">+----------------------------+</span>
       <span class="o">|</span>                    <span class="o">|</span>  <span class="n">surv_define_follow_up</span><span class="p">()</span>   <span class="o">|</span>  <span class="n">nordcansurvival_surv_define_follow_up</span><span class="o">.</span><span class="n">r</span>
       <span class="o">|</span>                    <span class="o">|</span>  <span class="n">surv_statistics</span><span class="p">()</span>         <span class="o">|</span>  <span class="n">nordcansurvival_surv_statistics</span><span class="o">.</span><span class="n">r</span>
       <span class="o">|</span>                    <span class="o">|</span>  <span class="n">surv_export</span><span class="p">()</span>             <span class="o">|</span>  <span class="n">nordcansurvival_surv_export</span><span class="o">.</span><span class="n">r</span>
       <span class="o">|</span>                    <span class="o">+----------------------------+</span>
       <span class="o">+---------------&gt;</span>    <span class="o">|</span>  <span class="n">surv_main</span><span class="p">()</span>               <span class="o">|</span>  <span class="n">calling</span> <span class="n">the</span> <span class="n">above</span> <span class="n">functions</span>
                            <span class="o">+----------------------------+</span>  <span class="n">to</span> <span class="n">do</span> <span class="n">a</span> <span class="n">complete</span> <span class="n">analysis</span> <span class="n">according</span> <span class="n">to</span> <span class="n">spec</span><span class="o">.</span>
</pre></div>
</div>
<p><a class="reference external" href="file://H:/NORDCAN/NC_S/doc/test/Sphinx/flow2.svg">file://H:/NORDCAN/NC_S/doc/test/Sphinx/flow2.svg</a></p>
<ul class="simple">
<li><p><em>surv_preprocessing()</em> might not be neccassary (for first version)</p></li>
</ul>
</div>
</div>
<div class="section" id="use-case-r-nordcansurvival">
<h2>Use case: R nordcansurvival<a class="headerlink" href="#use-case-r-nordcansurvival" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-nordcanepistats">
<h3>from nordcanepistats<a class="headerlink" href="#from-nordcanepistats" title="Permalink to this headline">¶</a></h3>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [define cohort fup] → [analyze] → [export] ( data.table in {statistical payload} &lt;- fread(input) )</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_main</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># run all analyses and export resulst to statistical payload</span>
</pre></div>
</div>
</div>
<div class="section" id="from-nordcansurvival">
<h3>from nordcansurvival<a class="headerlink" href="#from-nordcansurvival" title="Permalink to this headline">¶</a></h3>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [preprocess] → [define cohort fup] → [analyze]</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_preprocess</span><span class="p">()</span>  <span class="c1"># may not be neccassary ( in first version )</span>
<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_define_follow_up</span><span class="p">(</span><span class="n">cohort</span><span class="p">)</span>
<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_statistics</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">stnet</span><span class="p">,</span> <span class="n">pohar</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="c1"># defaults to NC specification</span>
</pre></div>
</div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [define period fup] → [analyze]</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_define_follow_up</span><span class="p">(</span><span class="n">period_window</span><span class="p">,</span> <span class="n">start_date</span> <span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>  <span class="c1"># 5-year and 10-year (selected intities)</span>
<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_statistics</span><span class="p">(</span><span class="n">ns</span><span class="p">,</span> <span class="n">pohar</span><span class="p">,</span> <span class="n">stnet</span><span class="p">,</span> <span class="kc">...</span><span class="p">)</span> <span class="c1"># defaults to NC specification</span>
</pre></div>
</div>
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="c1"># [export]</span>

<span class="n">nordcansurvival</span><span class="o">::</span><span class="nf">surv_export</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span> <span class="c1"># →  data.table in {statistical payload} &lt;- fread(input)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="number-of-analysis-neccessary-nordcansurvival-surv-statistics">
<h2>Number of analysis neccessary ( nordcansurvival::surv_statistics )<a class="headerlink" href="#number-of-analysis-neccessary-nordcansurvival-surv-statistics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="follow-up">
<h3>Follow-up:<a class="headerlink" href="#follow-up" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li><p>cohort definition 0-10 years (all but last calendar period(s))</p></li>
<li><p>period definition 05 year  (last calendar period)</p></li>
<li><p>period definition 10 year  (last calendar period)</p></li>
</ol>
</div></blockquote>
<p>Any subsetting necessary due to memmory constraints.</p>
</div>
<div class="section" id="one-row-per-group-to-be-analysed">
<h3>One row per group to be analysed:<a class="headerlink" href="#one-row-per-group-to-be-analysed" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li><p>All sites</p></li>
<li><p>All sites but non-melanoma skin cancer</p></li>
<li><p>All sites but non-melanoma skin cancer, breast and prostate</p></li>
<li><p>other groups to be analyzed</p></li>
</ol>
</div></blockquote>
</div>
<div class="section" id="nordcansurvival-functions">
<h3>nordcansurvival functions<a class="headerlink" href="#nordcansurvival-functions" title="Permalink to this headline">¶</a></h3>
<div class="section" id="preprocessing">
<h4>preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>exclutions</p></li>
<li><p>asserts</p></li>
<li><p>possibly adding variables</p></li>
</ol>
</div>
<div class="section" id="defining-fup">
<h4>defining fup<a class="headerlink" href="#defining-fup" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>cohort</p></li>
<li><p>period window 5-year</p></li>
<li><p>period window 10-year</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="id1">
<h2>Use case: R nordcansurvival<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NORDCAN SURVIVAL MODULE</a><ul>
<li><a class="reference internal" href="#project-pages">Project pages</a><ul>
<li><a class="reference internal" href="#external">external</a></li>
<li><a class="reference internal" href="#internal-crn">internal (CRN)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#package-description">package description</a><ul>
<li><a class="reference internal" href="#stnet">stnet</a></li>
<li><a class="reference internal" href="#life-table">life table</a></li>
<li><a class="reference internal" href="#age-standardization">age-standardization</a><ul>
<li><a class="reference internal" href="#method">method</a></li>
<li><a class="reference internal" href="#weights">weights</a></li>
<li><a class="reference internal" href="#small-n-rule">small N rule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#input-nc-s-data">Input: <em>NC-S data</em></a><ul>
<li><a class="reference internal" href="#data-flow">data flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#to-do"><strong>TO DO</strong></a><ul>
<li><a class="reference internal" href="#integration">Integration</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a><ul>
<li><a class="reference internal" href="#to-be-installed-locally">To be installed locally</a></li>
<li><a class="reference internal" href="#r-packages">R-packages</a></li>
<li><a class="reference internal" href="#stata-packages">Stata-packages</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#issues">Issues</a></li>
<li><a class="reference internal" href="#what-about-lookuptable-icd10-entity-dta">WHAT about lookuptable_icd10_entity.dta</a></li>
<li><a class="reference internal" href="#order-of-entities-groups">Order of entities groups ?</a></li>
<li><a class="reference internal" href="#mapping-of-entities-descriptions-sla-email-22-april-attached-xlsx-files">Mapping of entities descriptions (SLA email 22 April attached xlsx files)</a></li>
<li><a class="reference internal" href="#stata-file-with-entities-descriptions">Stata file with entities descriptions</a></li>
<li><a class="reference internal" href="#code-r-nordcan-basicepistats-survival-r">Code: R nordcan_basicepistats_survival.R</a></li>
<li><a class="reference internal" href="#code-stata-stata-nordcan-rs-ado">Code: Stata stata_nordcan_rs.ado</a></li>
</ul>
</li>
<li><a class="reference internal" href="#r-package-nordcansurvival">R package nordcansurvival</a><ul>
<li><a class="reference internal" href="#objectives">Objectives</a><ul>
<li><a class="reference internal" href="#nordcansurvival-should-provide-functions-for">nordcansurvival should provide functions for</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-case-r-nordcansurvival">Use case: R nordcansurvival</a><ul>
<li><a class="reference internal" href="#from-nordcanepistats">from nordcanepistats</a></li>
<li><a class="reference internal" href="#from-nordcansurvival">from nordcansurvival</a></li>
</ul>
</li>
<li><a class="reference internal" href="#number-of-analysis-neccessary-nordcansurvival-surv-statistics">Number of analysis neccessary ( nordcansurvival::surv_statistics )</a><ul>
<li><a class="reference internal" href="#follow-up">Follow-up:</a></li>
<li><a class="reference internal" href="#one-row-per-group-to-be-analysed">One row per group to be analysed:</a></li>
<li><a class="reference internal" href="#nordcansurvival-functions">nordcansurvival functions</a><ul>
<li><a class="reference internal" href="#preprocessing">preprocessing</a></li>
<li><a class="reference internal" href="#defining-fup">defining fup</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id1">Use case: R nordcansurvival</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/xindex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NORDCAN SURVIVAL MODULE</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.1.
    </div>
  </body>
</html>